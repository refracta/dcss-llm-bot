{"title":"Trap","url":"http://crawl.chaosforge.org/Trap","type":"raw","data":"{{version031}}\n'''Traps''' (represented by '''[[^]]''') are [[Dungeon features]] that harm the player or [[monster]]s who step on them. There are two types of traps: physical traps, which are always revealed to the player, and [[#Malevolent Force|malevolent force]], which is triggered by the player randomly, on exploration. Most traps are magical in nature.\n\n==Physical traps==\nPhysical traps are always revealed to the player (but not necessarily to monsters). They can only be triggered by the player, or by monsters when they are in [[line of sight]] of the player. Flying creatures trigger traps in the same way as non-flying creatures.\n\nThere are six types of physical trap that generate randomly throughout the [[Dungeon]] and its branches:\n*[[File:Temporary teleport trap.png]] '''[[Teleport trap]]s''', which teleport anything that steps on the trap while in line of sight of the player to a different location on the current level. Destroyed when triggered.\n*[[File:Alarm_trap.png]] '''[[Alarm trap]]s''', which make an extremely loud noise and apply [[Sentinel's Mark]] to the player when the player or any monster steps on the trap. Destroyed when triggered.\n*[[File:Shaft.png]] '''[[Shaft]]s''', which will cause monsters to fall 1-3 floors to a lower floor in the current branch when a monster steps on the shaft and fails a chance based on their intelligence and hit dice. Players can step on shafts safely, and pressing '''>''' will cause the player to fall through the shaft if they wish. Destroyed when triggered.\n*[[File:Dispersal_trap.png]] '''[[Dispersal trap]]s''', which blink the player and all monsters in line of sight of the trap when the player or a monster steps on the trap. These traps are permanent.\n*[[File:Zot_trap.png]] '''[[Zot trap]]s''', which cause random harmful effects to the player, possibly including teleporting them, creating dangerous summoned or durably summoned monsters, causing an explosion dealing damage to the player, or invoking dangerous levels of [[magical contamination]], when the player or any monster steps on the trap while in line of sight of the player. When monsters step on the trap, there is only a chance for the player to be affected—this is indicated by the message \"The power of Zot is invoked against you!\". These traps are permanent.\n*[[File:Web.png]] '''[[Web]]s''', found most commonly in the [[Spider's Nest]], can cause the player and non-[[List of arachnids|spider]] monsters to become trapped and be given the Held status, halving their [[evasion]] and preventing melee and ranged combat. Webs on the floor are permanent, while those created by [[Ensnare]] or [[jumping spider]]s are destroyed when the player breaks or blinks out of them.\n\nThere are three more types of physical trap that can only be generated by [[vault]]s, most notably being seen in the [[hall of Zot]] on [[Zot:5]] and the [[Tomb]]:\n\n*[[File:Teleport_trap.png]] '''Permanent teleport traps''', which have the same effect as regular teleport traps but are not destroyed when triggered.\n*[[File:Net_trap.png]] '''[[Net trap]]s''', which fire a [[throwing net]] at the player, with [[to-hit]] dependent on the absolute depth of the trap, when the player or any [[monster intelligence|intelligent]] monster steps on the trap while in line of sight of the player. These traps are triggered 1/3 of the time when stepped on by the monster. Not destroyed when triggered.\n*[[File:Pressure_plate.png]] '''[[Pressure plate]]s''', which usually release monsters to surround the player when anything steps on the trap in line of sight of the player. The monsters released depend on the branch: in most branches, 8 [[redback]]s will be released. In the [[Snake Pit]], this is replaced by 8 [[black mamba]]s and [[mana viper]]s, and in the [[Realm of Zot]], this is replaced by a \"klown kar\"—3-8 [[Killer Klown]]s will be released. A few vaults have pressure plates that trigger different effects. These are always destroyed when triggered.\n\n==Malevolent Force==\nWhen exploring new tiles that haven't been seen before, there is a depth-based chance that the player will trigger one of three '''malevolent force''' effects:\n*'''Alarm trap effect''': the same as if the player stepped on an alarm trap; causes an extremely loud noise and [[Sentinel's Mark|marks]] the player. This effect cannot be triggered on D:1-3.\n*'''Shaft effect''': the same as if the player voluntarily took a physical shaft; causes the player to fall 1-3 floors deeper in the branch with no immediate way to return to the higher floor. See '''[[Shaft#Exploration Shafts|Exploration Shafts]]''' for when they can and can not trigger.\n*'''Teleport effect''': causes you to be teleported to a random location on the current floor that is next to monsters, like the [[teleportitis]] mutation. This effect will fail to trigger if the game cannot find any such locations on the current floor.\n\nNote that new tiles revealed immediately after a shaft or teleport effect won't trigger another trap effect, giving the player a bit of a break post-trap.\n\nWorshippers of [[Ashenzari]] with at least 4* of piety are completely immune to these effects.\n\n===Chance to trigger===\nWhen malevolent force is triggered, it randomly chooses a valid effect with an equal chance of each.\n\nThe chance for a given turn to trigger a malevolent force effect is:\n\n (number of floor tiles revealed on this turn / number of floor tiles on current level) * (1 + absdepth of current level/10) / 9\n\nThe chance for one or more malevolent forces to trigger on a given level is therefore simply <code>(1 + absdepth/10) / 9</code>.\nThis leads to the following chances of the game attempting to trigger one or more exploration-triggered traps on any given level:\n{| class=\"prettytable\"\n! Branch !! Chance per floor\n|-\n| D:1-9 || 1/9\n|-\n| D:10-15<br>Lair<br>Orcish Mines || 2/9\n|-\n| Elven Halls<br>Swamp / Shoals<br>Snake Pit / Spider Nest<br>Slime:1-2  || 2/9\n|-\n| Slime:3-5<br>Vaults<br>Depths || 3/9\n|-\n| Crypt<br>Tomb<br>Pandemonium<br>Vestible of Hell<br>Hell Branch:1 || 3/9\n|-\n| Hell Branch:2-7 || 4/9\n|-\n| Zot:1-2 || 3/9\n|-\n| Zot:3-5 || 4/9\n|}\nThe above chances are for the game to attempt to trap the player. Given that there are many situations when the shaft and teleport effects can fail, this does not accurately reflect the chance of actually being trapped on a given floor. Situations when a particular trap effect fails are not announced.\n\n<!-- Commented out because I'm not at all convinced that this is correct -- NormalPerson7\n==Monsters & Traps==\nDifferent monsters react differently to traps. Most monsters with animalistic intelligence or above will avoid ones they know about, and refuse to cross a trap that is harmful to them even if there is no other way to reach you. [[Monster_intelligence|Mindless]] monsters like [[zombie]]s will walk through traps regardless of how much damage it might cause them.\n\nIn some situations, monsters already know the locations of traps:\n*Monsters native to a [[dungeon branch]] (e.g. [[orc]]s in the [[Orcish Mines]]) already know the locations of all traps in their branch, since they live there.\n*Monsters friendly to the player, and good neutrals, know the location of all traps, since it's assumed that you would tell them about the traps.\n*Monsters with human [[intelligence]] or greater have a 1 in 3 chance of knowing about the existence of any single trap.\n-->\n\n==Obsolete Traps==\nOver the years, many traps have been removed from the game for various reasons.\n*'''Mechanical traps''' were all removed in [[0.27]].\n**[[File:Arrow_trap.png]] '''[[Arrow trap]]s'''.\n**[[File:Blade_trap.png]] '''[[Blade trap]]s'''.\n**[[File:Bolt trap.png]] '''[[Bolt trap]]s'''.\n**[[File:Dart_trap.png]] '''[[Dart trap]]s'''.\n**[[File:Spear_trap.png]] '''[[Spear trap]]s'''.\n**[[File:Needle_trap.png]] '''[[Needle trap]]s''' were replaced with dart traps in [[0.24]].\n**[[File:Axe_trap.png]]''' [[Axe trap]]s''' were removed in [[0.11]].\n*[[File:Shadow_trap.png]] '''[[Shadow trap]]s''' were added in [[0.16]] and removed in [[0.17]].\n*[[File:Gas_trap.png]] ''' [[Gas trap]]s''' were removed in [[0.13]].\n\n==History==\n*Prior to [[0.31]], malevolent force was known as sourceless malevolence.\n*Prior to [[0.29]], exploration [[shaft]] traps in the Dungeon branch didn't try to drop you into a place without monsters.\n*Prior to [[0.28]], sourceless malevolence effects was known as exploration traps, and exploration shaft traps were not limited to once per branch.\n*Prior to [[0.25]], monsters couldn't spawn on top of traps. As a result, [[Animate Dead]] had no effect on [[corpse]]s that were on tiles with [[web]]s. Also, scrolls of [[magic mapping]] didn't reveal traps.\n*In [[0.24]], exploration trap effects were made to only pick from eligible exploration effects.\n*In [[0.23]], traps were reworked. Prior to this version:\n**Exploration traps did not exist. Instead, physical traps were often hidden from the player, with an XL-based chance to be detected. [[Ashenzari]] increased the trap detection chance.\n**[[Dispersal trap]]s were introduced.\n**Alarm and net traps did not affect the player if a monster stepped on them.\n**Monsters could trigger physical traps, even if they were outside of the player's [[line of sight]].\n**The trap layout in areas like [[hall of Zot]] in [[Zot:5]] and the [[Tomb]] were very different.\n*Prior to [[0.16]], flying players and monsters could avoid triggering traps. Shadow traps were added, and trap disarming was removed in this version.\n*Prior to [[0.15]], mechanical traps dropped ammunition and all teleport traps were permanent.\n*Prior to [[0.13]], mechanical traps were randomly placed throughout every branch. Trap detection was based on the [[Traps (skill)|Traps]] skill.\n*Prior to [[0.12]], Traps could be detected by searching (command '''s''').\n*Prior to [[0.11]], trap damage scaled with the floor's depth.\n\n==References==\n<references />\n\n[[Category:Traps]]"}