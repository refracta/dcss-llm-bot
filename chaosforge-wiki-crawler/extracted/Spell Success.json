{"title":"Spell Success","url":"http://crawl.chaosforge.org/Spell_Success","type":"markdown","data":"***Version [0.31](/0.31 \"0.31\")**: This article **may not be** up to date for the [latest stable release](/0.32 \"0.32\") of Crawl.*\n\n|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |\n| ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| ## Contents* [1 Base Chance](#Base_Chance)\n\n  - [1.1 Spell skills](#Spell_skills)\n  - [1.2 Spell difficulty](#Spell_difficulty)\n  - [1.3 Encumbrance penalties](#Encumbrance_penalties)\n\n* [2 Step down](#Step_down)\n\n* [3 Modifiers](#Modifiers)\n\n* [4 Final Step](#Final_Step)\n\n* [5 Strategy](#Strategy)\n\n* [6 Analysis](#Analysis)\n\n  - [6.1 Skill Req'd to Cast L9 Spells](#Skill_Req.27d_to_Cast_L9_Spells)\n  - [6.2 Measuring Encumbrance](#Measuring_Encumbrance)\n  - [6.3 Armour skill vs Spell skill](#Armour_skill_vs_Spell_skill)\n  - [6.4 Strength vs Intelligence](#Strength_vs_Intelligence)\n\n* [7 See also](#See_also)\n\n* [8 History](#History)\n\n* [9 References](#References) |\n\n**Spell success** is the rate at which casting a [spell](/Spell \"Spell\") can be expected to succeed. Spell success rate is determined by a complex combination of:\n\n1. Spell level\n2. Spell-related skills, [Intelligence](/Intelligence \"Intelligence\")\n3. Penalties from [body armour](/Body_armour \"Body armour\") and [shields](/Shields \"Shields\") (mitigated by [Armour skill](/Armour_\\(skill\\) \"Armour (skill)\") / [Shields skill](/Shields_\\(skill\\) \"Shields (skill)\"))\n4. Modifiers like [Wizardry](/Wizardry \"Wizardry\") and [Wild Magic](/Good_mutations#Wild_Magic \"Good mutations\")\n\n## Base Chance\n\nThe source code talks in terms of chance of *failure*, not success. Therefore, we want the spellFailure chance to be as low as possible - in fact, to reach a 0% failure rate, your chance to fail has to be **negative**. More on that below.\n\nThe base failure before *any* modifiers is as follows:[\\[1\\]](#cite_note-1)\n\n```\n spellFailure = 60\n              - [6 * spell_skills]\n              - [2 * Intelligence]\n              + Spell difficulty\n              + Encumbrance penalties\n```\n\n- 60 is an arbitrary base chance of failure.\n- Increasing intelligence and spell skills (skills respective to the spell *and* [Spellcasting](/Spellcasting \"Spellcasting\")) will decrease failure.\n- Higher level spells are more difficult, wearing armour/shields make it more difficult.\n\n### Spell skills\n\n\"Spell\\_skills\" takes into account Spellcasting and an average of a spell's schools (e.g. a Conjurations / Fire spell will take the average of the [Conjurations](/Conjurations \"Conjurations\") skill and [Fire Magic](/Fire_Magic \"Fire Magic\") skill). This is calculated with the following equation:[\\[2\\]](#cite_note-2) [\\[3\\]](#cite_note-3)\n\n```\n spell_skills = [Spellcasting / 2] + [Average(Skill_level) * 2]\n```\n\n### Spell difficulty\n\nHigher level spells are more difficult. Each level of spell adds a number to your spell failure rate:[\\[4\\]](#cite_note-4)\n\n```\n spellDifficulty =   3 (level 1)\n                    15 (level 2)   (+12)\n                    35 (level 3)   (+20)\n                    70 (level 4)   (+35)\n                   100 (level 5)   (+30)\n                   150 (level 6)   (+50)\n                   200 (level 7)   (+50)\n                   260 (level 8)   (+60)\n                   340 (level 9)   (+80)\n```\n\n### Encumbrance penalties\n\nBoth Armour and Shield penalties for spells are derived from their [EV](/EV \"EV\") penalties. First, calculate the ev penalty, then calculate the spell penalty. Armour and Shields do not influence each other.\n\n**Armour**[\\[5\\]](#cite_note-5)[\\[6\\]](#cite_note-6)\n\n```\n ev penalty = 1/225 * encumbrance^2 * (90 - 2 * armour_skill) / (str + 3)\n spell penalty = 19 * ev penalty\n```\n\n**Shield**[\\[7\\]](#cite_note-7)[\\[8\\]](#cite_note-8)\n\n```\n ev penalty = 2/5 * encumbrance^2 / (5 + str) * (27 - shield_skill) / 27\n spell penalty = 19 * ev penalty\n```\n\n## Step down\n\nAt this point, the spell failure is put through a complicated post-processing curve:[\\[9\\]](#cite_note-9)\n\n```\n(x^3 + 426x^2 + 82670x + 6983254) / 262144 IF spellFailure < 43\n```\n\nThis replicates a step-down curve:\n\n[![](/images/3/32/Spell_success_stepdown.png)](/File:Spell_success_stepdown.png)\n\n\n\nx-axis = spellFailure, y-axis = Raw Failure Rate\n\nThis curve has the following points:\n\n| SpellFailure | Raw fail chance |\n| ------------ | --------------- |\n| 43           | 43%             |\n| 25           | 36.6%           |\n| 0            | 27.7%           |\n| -50          | 15.5%           |\n| -72          | 10%             |\n| -100         | 8.5%            |\n| -173         | 0%              |\n\n## Modifiers\n\nThe following modifiers are added after the STEPPED DOWN failure rates above. However, it is still considered the *raw spell failure chance*, which is adjusted by a sigmoid function later.[\\[10\\]](#cite_note-10)\n\n**Positive (+spell failure):**\n\n- [Wild Magic](/Wild_Magic_\\(mutation\\) \"Wild Magic (mutation)\"): +4% per level\n- Disrupted Magic (-Wiz) [sacrifice](/Ru \"Ru\"): +4% per level\n- [Orb](/Orb \"Orb\") of [energy](/Energy \"Energy\"): +10%\n  - [Crystal ball of Wucad Mu](/Crystal_ball_of_Wucad_Mu \"Crystal ball of Wucad Mu\"): +10%\n- [Vertigo](/Vertigo \"Vertigo\"): +7%\n\n**Negative (-spell failure):**\n\n- [Subdued Magic](/Subdued_Magic \"Subdued Magic\"): -2% per level\n- [Wizardry](/Wizardry \"Wizardry\"): multiplied by ×`6 / (7 + sources)`%, assuming you have at least one source. (×75% for Wiz x1, ×66.6% for Wiz x2, and so on.)\n- [Vehumet](/Vehumet \"Vehumet\"): multiplied by ×66.6%.[\\[11\\]](#cite_note-11) (Note: this is not considered a source of wizardry, but it multiplicatively stacks with wizardry.)\n\nThe wizardry and Vehumet multipliers are applied after all others.[\\[12\\]](#cite_note-12)\n\nAfter all modifiers have applied, you will get a cumulative *raw spell failure chance*. This is converted into the final success via the function below.\n\n## Final Step\n\nIn short, the game doesn't compare your raw failure chance with a number from 0 to 99. Instead, it compares the raw failure to the sum of three numbers divided by three.[\\[13\\]](#cite_note-13)\n\n```\n(1d101 + 1d101 + 1d100 - 3)/3 < fail chance\n```\n\nThis is equivalent to applying this transformation to the chance of failure:\n\n[![Spell success transformation.png](/images/a/a4/Spell_success_transformation.png)](/File:Spell_success_transformation.png)\n\nThis sigmoid function makes it more difficult to decrease your failure rate when it is high or low, but it will go down very quickly when it is in the middle. For raw failures below 33%, one can use this formula:\n\n```\n N                 = (raw_failure_rate) * 3\n Real Failure Rate = N * (N+1) * (N+2) / 6 / 101 / 101 (in unit of %)\n```\n\nThis can be tabulated for usefulness.\n\n| SpellFailure Req'd\\* | Raw fail chance | Actual fail chance |\n| -------------------- | --------------- | ------------------ |\n| 13                   | 32%             | 14.9%              |\n| 7                    | 30%             | 12.3%              |\n| 1                    | 28%             | 10.0%              |\n| -6                   | 26%             | 8.1%               |\n| -12                  | 24%             | 6.4%               |\n| -20                  | 22%             | 4.9%               |\n| -28                  | 20%             | 3.7%               |\n| -37                  | 18%             | 2.7%               |\n| -47                  | 16%             | 1.9%               |\n| -58                  | 14%             | 1.3%               |\n| -71                  | 12%             | 0.8%               |\n\n\\*SpellFailure required to reach a given raw fail chance, *assuming you don't have any modifiers like [wizardry](/Wizardry \"Wizardry\")*. E.g. if you have wizardry x1, having 1 SpellFailure = (28% \\* 0.75) raw failure = 21% raw failure.\n\n## Strategy\n\nIt is debatable whether these formulae are of any practical use during a game.\n\nIt may be nice to know a few things from a strategic point of view.\n\n- High level spells take a massive amount of XP to train, and it can be useful to know how many levels you'd need.\n- You can quantize your level of armour [encumbrance](/Encumbrance \"Encumbrance\"). A caster could say \"a set of [fire dragon scales](/Fire_dragon_scales \"Fire dragon scales\") gives a spell penalty equal to 6 levels of each spell school\". Then, you could determine if wearing FDS is worth it, both short-term (\"can I cast a spell in this *right now*?\") and long-term (\"can I cast a spell in this *when I reach Zot*?\").\n- You can calculate the relative value of a skill. For example, you can see when a level of \\<Spell School> would be more valuable than a level of Armour skill, or when a point of [strength](/Strength \"Strength\") is worth more than a point of [intelligence](/Intelligence \"Intelligence\").\n\nOf course, this isn't necessary. You can derive most (if not all) of this information by just checking your spell failure in game. If you wear a pierce of armour, and determine that your spell failure is unacceptable, then don't wear that armour - no need to calculate it! After you trained your skill a bit, you can wear a desired armour again, and see if it's any better.\n\n## Analysis\n\n### Skill Req'd to Cast L9 Spells\n\nSay you wanted to [Fire Storm](/Fire_Storm \"Fire Storm\") reliably. For sake of example, we're trying to reach a 10% failure rate. You can look at the table above: to get a 10% actual failure rate, you'd need 28% raw failure. If you have no wizardry, 28% raw failure = 1 SpellFailure.\n\nUsing the [SpellFailure](#Base_Chance) calculations at the top of the page, you can calculate what's needed to get to 1 SpellFailure. For this example, assume you have 30 intelligence, no wizardry, and 0 encumbrance from armour/shields.\n\n```\n60 (base failure)\n+ 340 (level 9 spell)\n- 6 * [0.5 * spellcasting + 2 * avg_skill] (spell skills)\n- 30 * 2 (30 intelligence)\n+ 0 (encumbrance)\n\n= 340 - (3 * spellcasting) - (12 * avg_skill) = SpellFailure\n```\n\nWe want a SpellFailure = 1, so `340 - (3 * spellcasting) - (12 * avg_skill) = 1`. So if you had an Spellcasting skill of 14, you'd need 24.75 in avg\\_skill - that is, Fire Magic and Conjurations. If you had a Spellcasting skill of 22.7, you'd need 22.7 in Fire Magic and Conjurations.\n\nWizardry reduces your raw failure rate by x75% for 1 stack, x66% for 2 stacks, etc.. So if you had wizardry x1, you'd need a (28 / .75) = 37.3% raw failure before wizardry (which, in turn, equals 29.21 SpellFailure). The same calculations can be done for other amounts of wizardry.\n\nSo, assuming you have 30 int and 0 encumbrance, the following skills would reach the desired 10% actual failure rate:\n\n- **No Wizardry**: {14 Spellcasting, 24.75 avg\\_skill}, {22.7 Spellcasting, 22.7 avg\\_skill}\n- **Wizardry x1**: {14 Spellcasting, 22.49 avg\\_skill}, {20.7 Spellcasting, 20.7 avg\\_skill}\n- **Wizardry x2** / **Vehumet**: {14 Spellcasting, 21.5 avg\\_skill}, {20 Spellcasting, 20 avg\\_skill}\n- **Vehumet + Wizardry x1**: {14 Spellcasting, 20.2 avg\\_skill}, {18.9 Spellcasting, 18.9 avg\\_skill}\n\nThese numbers apply to any level 9 spell in the game, not just Fire Storm... again, *assuming you have 30 int / 0 encumbrance*. If you're wearing [swamp dragon scales](/Swamp_dragon_scales \"Swamp dragon scales\") and a [kite shield](/Kite_shield \"Kite shield\"), for instance, it'll take more skill to cast. Change the values of spell level, intelligence, encumbrance as you see fit.\n\n### Measuring Encumbrance\n\nThe effect of encumbrance on your actual % to fail is non-linear. However, it can be measured by \"levels of a spell school needed to compensate\".\n\n**Armour**\n\nBody armour increases SpellFailure by `19/225 * encumbrance^2 * (90 - 2 * Armour) / (str + 3)`. Having 1 level of every spell school (except Spellcasting) reduces SpellFailure by 12. Therefore, armour encumbrance can be measured in terms of skill levels, using the formula \\[SpellFailure Increase] / 12.\n\nAs an example: say you have 6 strength, are wearing [troll leather armour](/Troll_leather_armour \"Troll leather armour\") (encumbrance = 4), and have 0 Armour skill. Your SpellFailure would be `19/225 * 4^2 * (90 - 0) / (6 + 3)` = 13.51 SpellFailure, or 1.13 levels in each skill. That really isn't much in the grand scheme of things. By the time you get troll leather armour, you can negate a \\~1 level penalty.\n\nFor reference:\n\n- 10 strength, [leather armour](/Leather_armour \"Leather armour\"), 0 Armour skill: -0.78 levels in each skill\n- 10 strength, [ring mail](/Ring_mail \"Ring mail\") or [swamp dragon scales](/Swamp_dragon_scales \"Swamp dragon scales\"), 5 Armour skill: -2.12 levels in each skill\n- 10 strength, [fire dragon scales](/Fire_dragon_scales \"Fire dragon scales\"), 5 Armour skill: -5.24 levels in each skill\n\nRemember that things change based on strength and skill. Also remember that you can train Armour skill to lower the penalty (see [Armour skill vs Spell skill](#Armour_skill_vs_Spell_skill) for more).\n\n**Shields**\n\nShield increases SpellFailure by `38/5 * encumbrance^2 / (str + 5) * (27 - Shields)/27`. Using the same method as body armour, as seen above, you can get a number for shield encumbrance, too. Relative to armour, strength matters a little less, but Shields skill matters more.\n\nIf you have 6 strength, a [buckler](/Buckler \"Buckler\") (encumbrance = 5), and have 0 Shields skill, SpellFailure equals `38/5 * 5^2 / (6 + 5) * 27/27` = 17.27, or 1.44 levels in each skill. A [kite shield](/Kite_shield \"Kite shield\") would be 4x that, a [tower shield](/Tower_shield \"Tower shield\") would be 9x that.\n\n### Armour skill vs Spell skill\n\n- Armour skill reduces SpellFailure by `-Armour * 38/225 * encumbrance^2 / (str + 3)`.\n- Having 1 of every spell school (except Spellcasting) reduces SpellFailure by 12. Divide by number of spell schools if needed.\n- Therefore, each level in Armour is worth `19/1350 * encumbrance^2 / (str + 3)`, or roughly `1/71 * encumbrance^2 / (str + 3)`, levels in each spell school.\n\nFor example, if you have 11 strength and are wearing [fire dragon scales](/Fire_dragon_scales \"Fire dragon scales\"), the equation `1/71 * 11^2 / 14` = 0.122, or 8.21 Armour : 1 in each spell school. If you have a dual-school spell, like [Fireball](/Fireball \"Fireball\"), 4.1 Armour skill = 1 Earth Magic OR 1 Conjurations, while 8.21 Armour = 1 Earth AND Conjurations.\n\nOf course, this **ONLY** takes into account spell failure. Training Armour skill increases your defenses; training spell schools increases your power.\n\n### Strength vs Intelligence\n\n- For a given change in strength 'x', strength reduces both armour and shield encumbrance by:\n\n  - Armour: `(1/<str+3> - 1/<str+x+3>) * 19/225 * encumbrance^2 * (90 - 2 * Armour)`\n  - Shield: `(1/<str+5> - 1/<str+x+5>) * 38/5 * encumbrance^2 * (27 - Shields)/27`\n\n- Intelligence reduces SpellFailure by 2 per point.\n\nSay you have 11 strength, fire dragon scales, and 0 Armour skill. On level up, you have a choice of 2 str or 2 int. The impact of +2 str is equal to `(1/14 - 1/16) * 19/225 * 11^2 * (90 - 0)` = 8.21 SpellFailure, greater than 2\\*2 = 4 SpellFailure from intelligence.\n\nIf this 11 strength character is also wearing a [kite shield](/Kite_shield \"Kite shield\"), with 9 Shields skill, +2 strength would also give `(1/16 - 1/18) * 38/5 * 10^2 * 18/27` = 3.52 SpellFailure.\n\nOf course, intelligence also increases [spell power](/Spell_power \"Spell power\"), while strength reduces [EV](/EV \"EV\") penalties.\n\n## See also\n\n- [Spell power](/Spell_power \"Spell power\")\n- [Miscast effect](/Miscast_effect \"Miscast effect\")\n\n## History\n\n- Prior to [0.31](/0.31 \"0.31\"), the raw failure rate multiplier from wizardry/Vehumet was capped at 50%. Therefore, you could only have a maximum of 5 stacks of wizardry, or 1 stack of wizardry with Vehumet's bonus. Also, some [transmutations](/Transmutations \"Transmutations\") increased your spell failure: [Spider Form](/Spider_Form \"Spider Form\") (+10%) and [Blade Hands](/Blade_Hands_\\(spell\\) \"Blade Hands (spell)\") (+20%).\n- Prior to [0.22](/0.22 \"0.22\"), spell\\_schools went through a stepdown, `50 * log2(1 + spell_schools/50)`, which penalized the caster if `(Spellcasting/2) + (2* AvgSpellSchool) > 50`. However, spellFailure for level 9 spells was 330 instead of 340.\n- Prior to [0.20](/0.20 \"0.20\"), the [Step down](#Step_down) function was different, relying on breakpoints rather than a polynomial. Also, more breakpoints existed elsewhere in the spell failure calculation.\n\n## References\n\n1. [↑](#cite_ref-1) [spl-cast.cc:406](https://github.com/crawl/crawl/blob/0.30.0/crawl-ref/source/spl-cast.cc#L406) (0.30.0)\n2. [↑](#cite_ref-2) [spl-cast.cc:413](https://github.com/crawl/crawl/blob/0.30.0/crawl-ref/source/spl-cast.cc#L413) (0.30.0)\n3. [↑](#cite_ref-3) [spl-cast.cc:377](https://github.com/crawl/crawl/blob/0.30.0/crawl-ref/source/spl-cast.cc#L377) (0.30.0)\n4. [↑](#cite_ref-4) [spl-cast.cc:422](https://github.com/crawl/crawl/blob/0.30.0/crawl-ref/source/spl-cast.cc#L422) (0.30.0)\n5. [↑](#cite_ref-5) [player.cc:5723](https://github.com/crawl/crawl/blob/0.30.0/crawl-ref/source/player.cc#L5723) (0.30.0)\n6. [↑](#cite_ref-6) [player.cc:2131](https://github.com/crawl/crawl/blob/0.30.0/crawl-ref/source/player.cc#L2131) (0.30.0)\n7. [↑](#cite_ref-7) [player.cc:5739](https://github.com/crawl/crawl/blob/0.30.0/crawl-ref/source/player.cc#L5739) (0.30.0)\n8. [↑](#cite_ref-8) [player.cc:2134](https://github.com/crawl/crawl/blob/0.30.0/crawl-ref/source/player.cc#L2134) (0.30.0)\n9. [↑](#cite_ref-9) [spl-cast.cc:463](https://github.com/crawl/crawl/blob/0.30.0/crawl-ref/source/spl-cast.cc#L463) (0.30.0)\n10. [↑](#cite_ref-10) [spl-cast.cc:466](https://github.com/crawl/crawl/blob/0.30.0/crawl-ref/source/spl-cast.cc#L466) (0.30.0)\n11. [↑](#cite_ref-11) [spl-cast.cc:335](https://github.com/crawl/crawl/blob/0.30.0/crawl-ref/source/spl-cast.cc#L335) (0.30.0)\n12. [↑](#cite_ref-12) [spl-cast.cc:475](https://github.com/crawl/crawl/blob/0.30.0/crawl-ref/source/spl-cast.cc#L475) (0.30.0)\n13. [↑](#cite_ref-13) [spl-cast.cc:2533](https://github.com/crawl/crawl/blob/0.30.0/crawl-ref/source/spl-cast.cc#L2533) (0.30.0)\n","html":"<!DOCTYPE html>\n<html class=\"client-nojs\" lang=\"en\" dir=\"ltr\">\n<head>\n<meta charset=\"UTF-8\"/>\n<title>Spell Success - CrawlWiki</title>\n<script>document.documentElement.className = document.documentElement.className.replace( /(^|\\s)client-nojs(\\s|$)/, \"$1client-js$2\" );</script>\n<script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({\"wgCanonicalNamespace\":\"\",\"wgCanonicalSpecialPageName\":false,\"wgNamespaceNumber\":0,\"wgPageName\":\"Spell_Success\",\"wgTitle\":\"Spell Success\",\"wgCurRevisionId\":80120,\"wgRevisionId\":80120,\"wgArticleId\":550,\"wgIsArticle\":true,\"wgIsRedirect\":false,\"wgAction\":\"view\",\"wgUserName\":null,\"wgUserGroups\":[\"*\"],\"wgCategories\":[\"0.31 articles\",\"Magic\"],\"wgBreakFrames\":false,\"wgPageContentLanguage\":\"en\",\"wgPageContentModel\":\"wikitext\",\"wgSeparatorTransformTable\":[\"\",\"\"],\"wgDigitTransformTable\":[\"\",\"\"],\"wgDefaultDateFormat\":\"dmy\",\"wgMonthNames\":[\"\",\"January\",\"February\",\"March\",\"April\",\"May\",\"June\",\"July\",\"August\",\"September\",\"October\",\"November\",\"December\"],\"wgMonthNamesShort\":[\"\",\"Jan\",\"Feb\",\"Mar\",\"Apr\",\"May\",\"Jun\",\"Jul\",\"Aug\",\"Sep\",\"Oct\",\"Nov\",\"Dec\"],\"wgRelevantPageName\":\"Spell_Success\",\"wgRelevantArticleId\":550,\"wgRequestId\":\"7d1b2395d7a34d40b486f2b0\",\"wgIsProbablyEditable\":false,\"wgRelevantPageIsProbablyEditable\":false,\"wgRestrictionEdit\":[],\"wgRestrictionMove\":[]});mw.loader.state({\"site.styles\":\"ready\",\"noscript\":\"ready\",\"user.styles\":\"ready\",\"user\":\"ready\",\"user.options\":\"loading\",\"user.tokens\":\"loading\",\"ext.cite.styles\":\"ready\",\"ext.smw.style\":\"ready\",\"ext.smw.tooltip.styles\":\"ready\",\"mediawiki.legacy.shared\":\"ready\",\"mediawiki.legacy.commonPrint\":\"ready\",\"mediawiki.sectionAnchor\":\"ready\",\"mediawiki.skinning.interface\":\"ready\",\"skins.vector.styles\":\"ready\"});mw.loader.implement(\"user.options@0bhc5ha\",function($,jQuery,require,module){mw.user.options.set([]);});mw.loader.implement(\"user.tokens@014qz08\",function ( $, jQuery, require, module ) {\nmw.user.tokens.set({\"editToken\":\"+\\\\\",\"patrolToken\":\"+\\\\\",\"watchToken\":\"+\\\\\",\"csrfToken\":\"+\\\\\"});/*@nomin*/\n\n});mw.loader.load([\"ext.smw.style\",\"ext.smw.tooltips\",\"ext.cite.a11y\",\"site\",\"mediawiki.page.startup\",\"mediawiki.user\",\"mediawiki.hidpi\",\"mediawiki.page.ready\",\"mediawiki.toc\",\"mediawiki.searchSuggest\",\"skins.vector.js\"]);});</script>\n<link rel=\"stylesheet\" href=\"/load.php?debug=false&amp;lang=en&amp;modules=ext.cite.styles%7Cmediawiki.legacy.commonPrint%2Cshared%7Cmediawiki.sectionAnchor%7Cmediawiki.skinning.interface%7Cskins.vector.styles&amp;only=styles&amp;skin=vector\"/>\n<link rel=\"stylesheet\" href=\"/load.php?debug=false&amp;lang=en&amp;modules=ext.smw.style%7Cext.smw.tooltip.styles&amp;only=styles&amp;skin=vector\"/>\n<script async=\"\" src=\"/load.php?debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=vector\"></script>\n<meta name=\"ResourceLoaderDynamicStyles\" content=\"\"/>\n<link rel=\"stylesheet\" href=\"/load.php?debug=false&amp;lang=en&amp;modules=site.styles&amp;only=styles&amp;skin=vector\"/>\n<meta name=\"generator\" content=\"MediaWiki 1.30.0\"/>\n<link rel=\"ExportRDF\" type=\"application/rdf+xml\" title=\"Spell Success\" href=\"/index.php?title=Special:ExportRDF/Spell_Success&amp;xmlmime=rdf\"/>\n<link rel=\"shortcut icon\" href=\"/favicon.ico\"/>\n<link rel=\"search\" type=\"application/opensearchdescription+xml\" href=\"/opensearch_desc.php\" title=\"CrawlWiki (en)\"/>\n<link rel=\"EditURI\" type=\"application/rsd+xml\" href=\"http://crawl.chaosforge.org/api.php?action=rsd\"/>\n<!--[if lt IE 9]><script src=\"/resources/lib/html5shiv/html5shiv.min.js?40bd4\"></script><![endif]-->\n</head>\n<body class=\"mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Spell_Success rootpage-Spell_Success skin-vector action-view\">\t\t<div id=\"mw-page-base\" class=\"noprint\"></div>\n\t\t<div id=\"mw-head-base\" class=\"noprint\"></div>\n\t\t<div id=\"content\" class=\"mw-body\" role=\"main\">\n\t\t<script type=\"text/javascript\">\n\t\twindow.google_analytics_uacct = \"UA-3380984-8\";\n</script>\n<div class=\"adsense\">\n\t\t<script type=\"text/javascript\"><!--\n\t\tgoogle_ad_client = \"ca-pub-7088061744296615\";\n\t\t/* CrawlWiki skyscraper */\n\t\tgoogle_ad_slot = \"8196155564\";\n\t\tgoogle_ad_width = 160;\n\t\tgoogle_ad_height = 600;\n-->\n</script>\n<script type=\"text/javascript\"\nsrc=\"http://pagead2.googlesyndication.com/pagead/show_ads.js\">\n</script>\n</div>\n\n\t\t\t<a id=\"top\"></a>\n\n\t\t\t\t\t\t<div class=\"mw-indicators mw-body-content\">\n</div>\n\t\t\t<h1 id=\"firstHeading\" class=\"firstHeading\" lang=\"en\">Spell Success</h1>\n\t\t\t\t\t\t\t\t\t<div id=\"bodyContent\" class=\"mw-body-content\">\n\t\t\t\t\t\t\t\t\t<div id=\"siteSub\" class=\"noprint\">From CrawlWiki</div>\n\t\t\t\t\t\t\t\t<div id=\"contentSub\"></div>\n\t\t\t\t\t\t\t\t\t\t\t\t<div id=\"jump-to-nav\" class=\"mw-jump\">\n\t\t\t\t\tJump to:\t\t\t\t\t<a href=\"#mw-head\">navigation</a>, \t\t\t\t\t<a href=\"#p-search\">search</a>\n\t\t\t\t</div>\n\t\t\t\t<div id=\"mw-content-text\" lang=\"en\" dir=\"ltr\" class=\"mw-content-ltr\"><div class=\"mw-parser-output\"><div style=\"border: 1px solid #33FF66; background-color: #e0fae0; border-left: 15px solid #33FF66; margin-bottom: 20px; width: 100%; padding: 4px 10px; line-height: 1.1em; width: auto;\"><i><b>Version <a href=\"/0.31\" title=\"0.31\">0.31</a></b>: This article <b>may not be</b> up to date for the <a href=\"/0.32\" title=\"0.32\">latest stable release</a> of Crawl.</i></div>\n<table style=\"float: right;\">\n<tr>\n<td> <div id=\"toc\" class=\"toc\"><div class=\"toctitle\"><h2>Contents</h2></div>\n<ul>\n<li class=\"toclevel-1 tocsection-1\"><a href=\"#Base_Chance\"><span class=\"tocnumber\">1</span> <span class=\"toctext\">Base Chance</span></a>\n<ul>\n<li class=\"toclevel-2 tocsection-2\"><a href=\"#Spell_skills\"><span class=\"tocnumber\">1.1</span> <span class=\"toctext\">Spell skills</span></a></li>\n<li class=\"toclevel-2 tocsection-3\"><a href=\"#Spell_difficulty\"><span class=\"tocnumber\">1.2</span> <span class=\"toctext\">Spell difficulty</span></a></li>\n<li class=\"toclevel-2 tocsection-4\"><a href=\"#Encumbrance_penalties\"><span class=\"tocnumber\">1.3</span> <span class=\"toctext\">Encumbrance penalties</span></a></li>\n</ul>\n</li>\n<li class=\"toclevel-1 tocsection-5\"><a href=\"#Step_down\"><span class=\"tocnumber\">2</span> <span class=\"toctext\">Step down</span></a></li>\n<li class=\"toclevel-1 tocsection-6\"><a href=\"#Modifiers\"><span class=\"tocnumber\">3</span> <span class=\"toctext\">Modifiers</span></a></li>\n<li class=\"toclevel-1 tocsection-7\"><a href=\"#Final_Step\"><span class=\"tocnumber\">4</span> <span class=\"toctext\">Final Step</span></a></li>\n<li class=\"toclevel-1 tocsection-8\"><a href=\"#Strategy\"><span class=\"tocnumber\">5</span> <span class=\"toctext\">Strategy</span></a></li>\n<li class=\"toclevel-1 tocsection-9\"><a href=\"#Analysis\"><span class=\"tocnumber\">6</span> <span class=\"toctext\">Analysis</span></a>\n<ul>\n<li class=\"toclevel-2 tocsection-10\"><a href=\"#Skill_Req.27d_to_Cast_L9_Spells\"><span class=\"tocnumber\">6.1</span> <span class=\"toctext\">Skill Req'd to Cast L9 Spells</span></a></li>\n<li class=\"toclevel-2 tocsection-11\"><a href=\"#Measuring_Encumbrance\"><span class=\"tocnumber\">6.2</span> <span class=\"toctext\">Measuring Encumbrance</span></a></li>\n<li class=\"toclevel-2 tocsection-12\"><a href=\"#Armour_skill_vs_Spell_skill\"><span class=\"tocnumber\">6.3</span> <span class=\"toctext\">Armour skill vs Spell skill</span></a></li>\n<li class=\"toclevel-2 tocsection-13\"><a href=\"#Strength_vs_Intelligence\"><span class=\"tocnumber\">6.4</span> <span class=\"toctext\">Strength vs Intelligence</span></a></li>\n</ul>\n</li>\n<li class=\"toclevel-1 tocsection-14\"><a href=\"#See_also\"><span class=\"tocnumber\">7</span> <span class=\"toctext\">See also</span></a></li>\n<li class=\"toclevel-1 tocsection-15\"><a href=\"#History\"><span class=\"tocnumber\">8</span> <span class=\"toctext\">History</span></a></li>\n<li class=\"toclevel-1 tocsection-16\"><a href=\"#References\"><span class=\"tocnumber\">9</span> <span class=\"toctext\">References</span></a></li>\n</ul>\n</div>\n\n</td></tr></table>\n<p><b>Spell success</b> is the rate at which casting a <a href=\"/Spell\" title=\"Spell\">spell</a> can be expected to succeed.\nSpell success rate is determined by a complex combination of:\n</p>\n<ol><li> Spell level</li>\n<li> Spell-related skills, <a href=\"/Intelligence\" title=\"Intelligence\">Intelligence</a></li>\n<li> Penalties from <a href=\"/Body_armour\" class=\"mw-redirect\" title=\"Body armour\">body armour</a> and <a href=\"/Shields\" title=\"Shields\">shields</a> (mitigated by <a href=\"/Armour_(skill)\" title=\"Armour (skill)\">Armour skill</a> / <a href=\"/Shields_(skill)\" title=\"Shields (skill)\">Shields skill</a>)</li>\n<li> Modifiers like <a href=\"/Wizardry\" title=\"Wizardry\">Wizardry</a> and <a href=\"/Good_mutations#Wild_Magic\" title=\"Good mutations\">Wild Magic</a></li></ol>\n<h2><span class=\"mw-headline\" id=\"Base_Chance\">Base Chance</span></h2>\n<p>The source code talks in terms of chance of <i>failure</i>, not success. Therefore, we want the spellFailure chance to be as low as possible - in fact, to reach a 0% failure rate, your chance to fail has to be <b>negative</b>. More on that below.\n</p><p>The base failure before <i>any</i> modifiers is as follows:<sup id=\"cite_ref-1\" class=\"reference\"><a href=\"#cite_note-1\">&#91;1&#93;</a></sup>\n</p>\n<pre> spellFailure = 60\n              - [6 * spell_skills]\n              - [2 * Intelligence]\n              + Spell difficulty\n              + Encumbrance penalties\n</pre>\n<ul><li> 60 is an arbitrary base chance of failure.</li>\n<li> Increasing intelligence and spell skills (skills respective to the spell <i>and</i> <a href=\"/Spellcasting\" title=\"Spellcasting\">Spellcasting</a>) will decrease failure.</li>\n<li> Higher level spells are more difficult, wearing armour/shields make it more difficult.</li></ul>\n<h3><span class=\"mw-headline\" id=\"Spell_skills\">Spell skills</span></h3>\n<p>\"Spell_skills\" takes into account Spellcasting and an average of a spell's schools (e.g. a Conjurations / Fire spell will take the average of the <a href=\"/Conjurations\" title=\"Conjurations\">Conjurations</a> skill and <a href=\"/Fire_Magic\" title=\"Fire Magic\">Fire Magic</a> skill). This is calculated with the following equation:<sup id=\"cite_ref-2\" class=\"reference\"><a href=\"#cite_note-2\">&#91;2&#93;</a></sup>\n<sup id=\"cite_ref-3\" class=\"reference\"><a href=\"#cite_note-3\">&#91;3&#93;</a></sup>\n</p>\n<pre> spell_skills = [Spellcasting / 2] + [Average(Skill_level) * 2]\n</pre>\n<h3><span class=\"mw-headline\" id=\"Spell_difficulty\">Spell difficulty</span></h3>\n<p>Higher level spells are more difficult. Each level of spell adds a number to your spell failure rate:<sup id=\"cite_ref-4\" class=\"reference\"><a href=\"#cite_note-4\">&#91;4&#93;</a></sup>\n</p>\n<pre> spellDifficulty =   3 (level 1)\n                    15 (level 2)   (+12)\n                    35 (level 3)   (+20)\n                    70 (level 4)   (+35)\n                   100 (level 5)   (+30)\n                   150 (level 6)   (+50)\n                   200 (level 7)   (+50)\n                   260 (level 8)   (+60)\n                   340 (level 9)   (+80)\n</pre>\n<h3><span class=\"mw-headline\" id=\"Encumbrance_penalties\">Encumbrance penalties</span></h3>\n<p>Both Armour and Shield penalties for spells are derived from their <a href=\"/EV\" class=\"mw-redirect\" title=\"EV\">EV</a> penalties. First, calculate the ev penalty, then calculate the spell penalty. Armour and Shields do not influence each other.\n</p><p><b>Armour</b><sup id=\"cite_ref-5\" class=\"reference\"><a href=\"#cite_note-5\">&#91;5&#93;</a></sup><sup id=\"cite_ref-6\" class=\"reference\"><a href=\"#cite_note-6\">&#91;6&#93;</a></sup>\n</p>\n<pre> ev penalty = 1/225 * <a href=\"/Encumbrance\" class=\"mw-redirect\" title=\"Encumbrance\">encumbrance</a>^2 * (90 - 2 * <a href=\"/Armour_(skill)\" title=\"Armour (skill)\">armour_skill</a>) / (<a href=\"/Str\" class=\"mw-redirect\" title=\"Str\">str</a> + 3)\n spell penalty = 19 * ev penalty\n</pre>\n<p><b>Shield</b><sup id=\"cite_ref-7\" class=\"reference\"><a href=\"#cite_note-7\">&#91;7&#93;</a></sup><sup id=\"cite_ref-8\" class=\"reference\"><a href=\"#cite_note-8\">&#91;8&#93;</a></sup>\n</p>\n<pre> ev penalty = 2/5 * <a href=\"/Shields#EV_Penalty\" title=\"Shields\">encumbrance</a>^2 / (5 + str) * (27 - <a href=\"/Shields_(skill)\" title=\"Shields (skill)\">shield_skill</a>) / 27\n spell penalty = 19 * ev penalty\n</pre>\n<h2><span class=\"mw-headline\" id=\"Step_down\">Step down</span></h2>\n<p>At this point, the spell failure is put through a complicated post-processing curve:<sup id=\"cite_ref-9\" class=\"reference\"><a href=\"#cite_note-9\">&#91;9&#93;</a></sup>\n</p>\n<pre>(x^3 + 426x^2 + 82670x + 6983254) / 262144 IF spellFailure &lt; 43\n</pre>\n<p>This replicates a step-down curve:\n</p>\n<div class=\"center\"><div class=\"thumb tnone\"><div class=\"thumbinner\" style=\"width:592px;\"><a href=\"/File:Spell_success_stepdown.png\" class=\"image\"><img alt=\"\" src=\"/images/3/32/Spell_success_stepdown.png\" width=\"590\" height=\"372\" class=\"thumbimage\" /></a>  <div class=\"thumbcaption\"><div class=\"magnify\"><a href=\"/File:Spell_success_stepdown.png\" class=\"internal\" title=\"Enlarge\"></a></div>x-axis = spellFailure, y-axis = Raw Failure Rate</div></div></div></div>\n<p>This curve has the following points:\n</p>\n<table class=\"prettytable\" style=\"text-align: center\" border=\"1\">\n\n<tr>\n<th>SpellFailure</th>\n<th>Raw fail chance\n</th></tr>\n<tr>\n<td>43 </td>\n<td> 43%\n</td></tr>\n<tr>\n<td>25 </td>\n<td> 36.6%\n</td></tr>\n<tr>\n<td>0 </td>\n<td> 27.7%\n</td></tr>\n<tr>\n<td>-50 </td>\n<td> 15.5%\n</td></tr>\n<tr>\n<td>-72 </td>\n<td> 10%\n</td></tr>\n<tr>\n<td>-100 </td>\n<td> 8.5%\n</td></tr>\n<tr>\n<td>-173 </td>\n<td> 0%\n</td></tr>\n</table>\n<h2><span class=\"mw-headline\" id=\"Modifiers\">Modifiers</span></h2>\n<p>The following modifiers are added after the STEPPED DOWN failure rates above. However, it is still considered the <i>raw spell failure chance</i>, which is adjusted by a sigmoid function later.<sup id=\"cite_ref-10\" class=\"reference\"><a href=\"#cite_note-10\">&#91;10&#93;</a></sup>\n</p><p><b>Positive (+spell failure):</b>\n</p>\n<ul><li><a href=\"/Wild_Magic_(mutation)\" title=\"Wild Magic (mutation)\">Wild Magic</a>: +4% per level</li>\n<li>Disrupted Magic (-Wiz) <a href=\"/Ru\" title=\"Ru\">sacrifice</a>: +4% per level</li>\n<li><a href=\"/Orb\" title=\"Orb\">Orb</a> of <a href=\"/Energy\" title=\"Energy\">energy</a>: +10%\n<ul><li><a href=\"/Crystal_ball_of_Wucad_Mu\" title=\"Crystal ball of Wucad Mu\">Crystal ball of Wucad Mu</a>: +10%</li></ul></li>\n<li><a href=\"/Vertigo\" title=\"Vertigo\">Vertigo</a>: +7%</li></ul>\n<p><b>Negative (-spell failure):</b>\n</p>\n<ul><li><a href=\"/Subdued_Magic\" title=\"Subdued Magic\">Subdued Magic</a>: -2% per level</li>\n<li><a href=\"/Wizardry\" title=\"Wizardry\">Wizardry</a>: multiplied by ×<code>6 / (7 + sources)</code>%, assuming you have at least one source. (×75% for Wiz x1, ×66.6% for Wiz x2, and so on.)</li>\n<li><a href=\"/Vehumet\" title=\"Vehumet\">Vehumet</a>: multiplied by ×66.6%.<sup id=\"cite_ref-11\" class=\"reference\"><a href=\"#cite_note-11\">&#91;11&#93;</a></sup> (Note: this is not considered a source of wizardry, but it multiplicatively stacks with wizardry.)</li></ul>\n<p>The wizardry and Vehumet multipliers are applied after all others.<sup id=\"cite_ref-12\" class=\"reference\"><a href=\"#cite_note-12\">&#91;12&#93;</a></sup>\n</p><p>After all modifiers have applied, you will get a cumulative <i>raw spell failure chance</i>. This is converted into the final success via the function below.\n</p>\n<h2><span class=\"mw-headline\" id=\"Final_Step\">Final Step</span></h2>\n<p>In short, the game doesn't compare your raw failure chance with a number from 0 to 99. Instead, it compares the raw failure to the sum of three numbers divided by three.<sup id=\"cite_ref-13\" class=\"reference\"><a href=\"#cite_note-13\">&#91;13&#93;</a></sup>\n</p>\n<pre>(1d101 + 1d101 + 1d100 - 3)/3 &lt; fail chance\n</pre>\n<p>This is equivalent to applying this transformation to the chance of failure:\n</p><p><a href=\"/File:Spell_success_transformation.png\" class=\"image\"><img alt=\"Spell success transformation.png\" src=\"/images/a/a4/Spell_success_transformation.png\" width=\"640\" height=\"480\" /></a>\n</p><p>This sigmoid function makes it more difficult to decrease your failure rate when it is high or low, but it will go down very quickly when it is in the middle. For raw failures below 33%, one can use this formula:\n</p>\n<pre> N                 = (raw_failure_rate) * 3\n Real Failure Rate = N * (N+1) * (N+2) / 6 / 101 / 101 (in unit of&#160;%)\n</pre>\n<p>This can be tabulated for usefulness.\n</p>\n<table class=\"prettytable\" style=\"text-align: center\" border=\"1\">\n\n<tr>\n<th>SpellFailure Req'd*</th>\n<th>Raw fail chance</th>\n<th>Actual fail chance\n</th></tr>\n<tr>\n<td>13</td>\n<td>32%</td>\n<td>14.9%\n</td></tr>\n<tr>\n<td>7</td>\n<td>30%</td>\n<td>12.3%\n</td></tr>\n<tr>\n<td>1</td>\n<td>28%</td>\n<td>10.0%\n</td></tr>\n<tr>\n<td>-6</td>\n<td>26%</td>\n<td>8.1%\n</td></tr>\n<tr>\n<td>-12</td>\n<td>24%</td>\n<td>6.4%\n</td></tr>\n<tr>\n<td>-20</td>\n<td>22%</td>\n<td>4.9%\n</td></tr>\n<tr>\n<td>-28</td>\n<td>20%</td>\n<td>3.7%\n</td></tr>\n<tr>\n<td>-37</td>\n<td>18%</td>\n<td>2.7%\n</td></tr>\n<tr>\n<td>-47</td>\n<td>16%</td>\n<td>1.9%\n</td></tr>\n<tr>\n<td>-58</td>\n<td>14%</td>\n<td>1.3%\n</td></tr>\n<tr>\n<td>-71</td>\n<td>12%</td>\n<td>0.8%\n</td></tr>\n</table>\n<p>*SpellFailure required to reach a given raw fail chance, <i>assuming you don't have any modifiers like <a href=\"/Wizardry\" title=\"Wizardry\">wizardry</a></i>. E.g. if you have wizardry x1, having 1 SpellFailure = (28% * 0.75) raw failure = 21% raw failure.\n</p>\n<h2><span class=\"mw-headline\" id=\"Strategy\">Strategy</span></h2>\n<p>It is debatable whether these formulae are of any practical use during a game.\n</p><p>It may be nice to know a few things from a strategic point of view. \n</p>\n<ul><li>High level spells take a massive amount of XP to train, and it can be useful to know how many levels you'd need. </li>\n<li>You can quantize your level of armour <a href=\"/Encumbrance\" class=\"mw-redirect\" title=\"Encumbrance\">encumbrance</a>. A caster could say \"a set of <a href=\"/Fire_dragon_scales\" title=\"Fire dragon scales\">fire dragon scales</a> gives a spell penalty equal to 6 levels of each spell school\". Then, you could determine if wearing FDS is worth it, both short-term (\"can I cast a spell in this <i>right now</i>?\") and long-term (\"can I cast a spell in this <i>when I reach Zot</i>?\").</li>\n<li>You can calculate the relative value of a skill. For example, you can see when a level of &lt;Spell School&gt; would be more valuable than a level of Armour skill, or when a point of <a href=\"/Strength\" title=\"Strength\">strength</a> is worth more than a point of <a href=\"/Intelligence\" title=\"Intelligence\">intelligence</a>.</li></ul>\n<p>Of course, this isn't necessary. You can derive most (if not all) of this information by just checking your spell failure in game. If you wear a pierce of armour, and determine that your spell failure is unacceptable, then don't wear that armour - no need to calculate it! After you trained your skill a bit, you can wear a desired armour again, and see if it's any better.\n</p>\n<h2><span class=\"mw-headline\" id=\"Analysis\">Analysis</span></h2>\n<h3><span class=\"mw-headline\" id=\"Skill_Req.27d_to_Cast_L9_Spells\">Skill Req'd to Cast L9 Spells</span></h3>\n<p>Say you wanted to <a href=\"/Fire_Storm\" title=\"Fire Storm\">Fire Storm</a> reliably. For sake of example, we're trying to reach a 10% failure rate. You can look at the table above: to get a 10% actual failure rate, you'd need 28% raw failure. If you have no wizardry, 28% raw failure = 1 SpellFailure.\n</p><p>Using the <a href=\"#Base_Chance\">SpellFailure</a> calculations at the top of the page, you can calculate what's needed to get to 1 SpellFailure. For this example, assume you have 30 intelligence, no wizardry, and 0 encumbrance from armour/shields.\n</p>\n<pre>60 (base failure)\n+ 340 (level 9 spell)\n- 6 * [0.5 * spellcasting + 2 * avg_skill] (spell skills)\n- 30 * 2 (30 intelligence)\n+ 0 (encumbrance)<br /><br />= 340 - (3 * spellcasting) - (12 * avg_skill) = SpellFailure\n</pre>\n<p>We want a SpellFailure = 1, so <code>340 - (3 * spellcasting) - (12 * avg_skill) = 1</code>. So if you had an Spellcasting skill of 14, you'd need 24.75 in avg_skill - that is, Fire Magic and Conjurations. If you had a Spellcasting skill of 22.7, you'd need 22.7 in Fire Magic and Conjurations.\n</p><p>Wizardry reduces your raw failure rate by x75% for 1 stack, x66% for 2 stacks, etc.. So if you had wizardry x1, you'd need a (28 / .75) = 37.3% raw failure before wizardry (which, in turn, equals 29.21 SpellFailure). The same calculations can be done for other amounts of wizardry.\n</p><p>So, assuming you have 30 int and 0 encumbrance, the following skills would reach the desired 10% actual failure rate:\n</p>\n<ul><li><b>No Wizardry</b>: {14 Spellcasting, 24.75 avg_skill}, {22.7 Spellcasting, 22.7 avg_skill}</li>\n<li><b>Wizardry x1</b>: {14 Spellcasting, 22.49 avg_skill}, {20.7 Spellcasting, 20.7 avg_skill}</li>\n<li><b>Wizardry x2</b> / <b>Vehumet</b>: {14 Spellcasting, 21.5 avg_skill}, {20 Spellcasting, 20 avg_skill}</li>\n<li><b>Vehumet + Wizardry x1</b>: {14 Spellcasting, 20.2 avg_skill}, {18.9 Spellcasting, 18.9 avg_skill}</li></ul>\n<p>These numbers apply to any level 9 spell in the game, not just Fire Storm... again, <i>assuming you have 30 int / 0 encumbrance</i>. If you're wearing <a href=\"/Swamp_dragon_scales\" title=\"Swamp dragon scales\">swamp dragon scales</a> and a <a href=\"/Kite_shield\" title=\"Kite shield\">kite shield</a>, for instance, it'll take more skill to cast. Change the values of spell level, intelligence, encumbrance as you see fit.\n</p>\n<h3><span class=\"mw-headline\" id=\"Measuring_Encumbrance\">Measuring Encumbrance</span></h3>\n<p>The effect of encumbrance on your actual&#160;% to fail is non-linear. However, it can be measured by \"levels of a spell school needed to compensate\".\n</p><p><b>Armour</b>\n</p><p>Body armour increases SpellFailure by <code>19/225 * encumbrance^2 * (90 - 2 * Armour) / (str + 3)</code>. Having 1 level of every spell school (except Spellcasting) reduces SpellFailure by 12. Therefore, armour encumbrance can be measured in terms of skill levels, using the formula [SpellFailure Increase] / 12.\n</p><p>As an example: say you have 6 strength, are wearing <a href=\"/Troll_leather_armour\" title=\"Troll leather armour\">troll leather armour</a> (encumbrance = 4), and have 0 Armour skill. Your SpellFailure would be <code>19/225 * 4^2 * (90 - 0) / (6 + 3)</code> = 13.51 SpellFailure, or 1.13 levels in each skill. That really isn't much in the grand scheme of things. By the time you get troll leather armour, you can negate a ~1 level penalty.\n</p><p>For reference:\n</p>\n<ul><li>10 strength, <a href=\"/Leather_armour\" title=\"Leather armour\">leather armour</a>, 0 Armour skill: -0.78 levels in each skill</li>\n<li>10 strength, <a href=\"/Ring_mail\" title=\"Ring mail\">ring mail</a> or <a href=\"/Swamp_dragon_scales\" title=\"Swamp dragon scales\">swamp dragon scales</a>, 5 Armour skill:  -2.12 levels in each skill</li>\n<li>10 strength, <a href=\"/Fire_dragon_scales\" title=\"Fire dragon scales\">fire dragon scales</a>, 5 Armour skill: -5.24 levels in each skill</li></ul>\n<p>Remember that things change based on strength and skill. Also remember that you can train Armour skill to lower the penalty (see <a href=\"#Armour_skill_vs_Spell_skill\">Armour skill vs Spell skill</a> for more).\n</p><p><b>Shields</b>\n</p><p>Shield increases SpellFailure by <code>38/5 * encumbrance^2 / (str + 5) * (27 - Shields)/27</code>. Using the same method as body armour, as seen above, you can get a number for shield encumbrance, too. Relative to armour, strength matters a little less, but Shields skill matters more.\n</p><p>If you have 6 strength, a <a href=\"/Buckler\" title=\"Buckler\">buckler</a> (encumbrance = 5), and have 0 Shields skill, SpellFailure equals <code>38/5 * 5^2 / (6 + 5) * 27/27</code> = 17.27, or 1.44 levels in each skill. A <a href=\"/Kite_shield\" title=\"Kite shield\">kite shield</a> would be 4x that, a <a href=\"/Tower_shield\" title=\"Tower shield\">tower shield</a> would be 9x that.\n</p>\n<h3><span class=\"mw-headline\" id=\"Armour_skill_vs_Spell_skill\">Armour skill vs Spell skill</span></h3>\n<ul><li>Armour skill reduces SpellFailure by <code>-Armour * 38/225 * encumbrance^2 / (str + 3)</code>.</li>\n<li>Having 1 of every spell school (except Spellcasting) reduces SpellFailure by 12. Divide by number of spell schools if needed.</li>\n<li>Therefore, each level in Armour is worth <code>19/1350 * encumbrance^2 / (str + 3)</code>, or roughly <code>1/71 * encumbrance^2 / (str + 3)</code>, levels in each spell school. </li></ul>\n<p>For example, if you have 11 strength and are wearing <a href=\"/Fire_dragon_scales\" title=\"Fire dragon scales\">fire dragon scales</a>, the equation <code>1/71 * 11^2 / 14</code> = 0.122, or 8.21 Armour&#160;: 1 in each spell school. If you have a dual-school spell, like <a href=\"/Fireball\" title=\"Fireball\">Fireball</a>, 4.1 Armour skill = 1 Earth Magic OR 1 Conjurations, while 8.21 Armour = 1 Earth AND Conjurations.\n</p><p>Of course, this <b>ONLY</b> takes into account spell failure. Training Armour skill increases your defenses; training spell schools increases your power.\n</p>\n<h3><span class=\"mw-headline\" id=\"Strength_vs_Intelligence\">Strength vs Intelligence</span></h3>\n<ul><li>For a given change in strength 'x', strength reduces both armour and shield encumbrance by:\n<ul><li>Armour: <code>(1/&lt;str+3&gt; - 1/&lt;str+x+3&gt;) * 19/225 * encumbrance^2 * (90 - 2 * Armour)</code></li>\n<li>Shield: <code>(1/&lt;str+5&gt; - 1/&lt;str+x+5&gt;) * 38/5 * encumbrance^2 * (27 - Shields)/27</code></li></ul></li>\n<li>Intelligence reduces SpellFailure by 2 per point.</li></ul>\n<p>Say you have 11 strength, fire dragon scales, and 0 Armour skill. On level up, you have a choice of 2 str or 2 int. The impact of +2 str is equal to <code>(1/14 - 1/16) * 19/225 * 11^2 * (90 - 0)</code> = 8.21 SpellFailure, greater than 2*2 = 4 SpellFailure from intelligence.\n</p><p>If this 11 strength character is also wearing a <a href=\"/Kite_shield\" title=\"Kite shield\">kite shield</a>, with 9 Shields skill, +2 strength would also give <code>(1/16 - 1/18) * 38/5 * 10^2 * 18/27</code> = 3.52 SpellFailure.\n</p><p>Of course, intelligence also increases <a href=\"/Spell_power\" class=\"mw-redirect\" title=\"Spell power\">spell power</a>, while strength reduces <a href=\"/EV\" class=\"mw-redirect\" title=\"EV\">EV</a> penalties.\n</p>\n<h2><span class=\"mw-headline\" id=\"See_also\">See also</span></h2>\n<ul><li><a href=\"/Spell_power\" class=\"mw-redirect\" title=\"Spell power\">Spell power</a></li>\n<li><a href=\"/Miscast_effect\" title=\"Miscast effect\">Miscast effect</a></li></ul>\n<h2><span class=\"mw-headline\" id=\"History\">History</span></h2>\n<ul><li>Prior to <a href=\"/0.31\" title=\"0.31\">0.31</a>, the raw failure rate multiplier from wizardry/Vehumet was capped at 50%. Therefore, you could only have a maximum of 5 stacks of wizardry, or 1 stack of wizardry with Vehumet's bonus. Also, some <a href=\"/Transmutations\" title=\"Transmutations\">transmutations</a> increased your spell failure: <a href=\"/Spider_Form\" title=\"Spider Form\">Spider Form</a> (+10%) and <a href=\"/Blade_Hands_(spell)\" title=\"Blade Hands (spell)\">Blade Hands</a> (+20%).</li>\n<li>Prior to <a href=\"/0.22\" title=\"0.22\">0.22</a>, spell_schools went through a stepdown, <code>50 * log2(1 + spell_schools/50)</code>, which penalized the caster if <code>(Spellcasting/2) + (2* AvgSpellSchool) &gt; 50</code>. However, spellFailure for level 9 spells was 330 instead of 340.</li>\n<li>Prior to <a href=\"/0.20\" title=\"0.20\">0.20</a>, the <a href=\"#Step_down\">Step down</a> function was different, relying on breakpoints rather than a polynomial. Also, more breakpoints existed elsewhere in the spell failure calculation.</li></ul>\n<h2><span class=\"mw-headline\" id=\"References\">References</span></h2>\n<div class=\"mw-references-wrap mw-references-columns\"><ol class=\"references\">\n<li id=\"cite_note-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-1\">↑</a></span> <span class=\"reference-text\"><a rel=\"nofollow\" class=\"external text\" href=\"https://github.com/crawl/crawl/blob/0.30.0/crawl-ref/source/spl-cast.cc#L406\">spl-cast.cc:406</a> (0.30.0)</span>\n</li>\n<li id=\"cite_note-2\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-2\">↑</a></span> <span class=\"reference-text\"><a rel=\"nofollow\" class=\"external text\" href=\"https://github.com/crawl/crawl/blob/0.30.0/crawl-ref/source/spl-cast.cc#L413\">spl-cast.cc:413</a> (0.30.0)</span>\n</li>\n<li id=\"cite_note-3\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-3\">↑</a></span> <span class=\"reference-text\"><a rel=\"nofollow\" class=\"external text\" href=\"https://github.com/crawl/crawl/blob/0.30.0/crawl-ref/source/spl-cast.cc#L377\">spl-cast.cc:377</a> (0.30.0)</span>\n</li>\n<li id=\"cite_note-4\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-4\">↑</a></span> <span class=\"reference-text\"><a rel=\"nofollow\" class=\"external text\" href=\"https://github.com/crawl/crawl/blob/0.30.0/crawl-ref/source/spl-cast.cc#L422\">spl-cast.cc:422</a> (0.30.0)</span>\n</li>\n<li id=\"cite_note-5\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-5\">↑</a></span> <span class=\"reference-text\"><a rel=\"nofollow\" class=\"external text\" href=\"https://github.com/crawl/crawl/blob/0.30.0/crawl-ref/source/player.cc#L5723\">player.cc:5723</a> (0.30.0)</span>\n</li>\n<li id=\"cite_note-6\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-6\">↑</a></span> <span class=\"reference-text\"><a rel=\"nofollow\" class=\"external text\" href=\"https://github.com/crawl/crawl/blob/0.30.0/crawl-ref/source/player.cc#L2131\">player.cc:2131</a> (0.30.0)</span>\n</li>\n<li id=\"cite_note-7\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-7\">↑</a></span> <span class=\"reference-text\"><a rel=\"nofollow\" class=\"external text\" href=\"https://github.com/crawl/crawl/blob/0.30.0/crawl-ref/source/player.cc#L5739\">player.cc:5739</a> (0.30.0)</span>\n</li>\n<li id=\"cite_note-8\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-8\">↑</a></span> <span class=\"reference-text\"><a rel=\"nofollow\" class=\"external text\" href=\"https://github.com/crawl/crawl/blob/0.30.0/crawl-ref/source/player.cc#L2134\">player.cc:2134</a> (0.30.0)</span>\n</li>\n<li id=\"cite_note-9\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-9\">↑</a></span> <span class=\"reference-text\"><a rel=\"nofollow\" class=\"external text\" href=\"https://github.com/crawl/crawl/blob/0.30.0/crawl-ref/source/spl-cast.cc#L463\">spl-cast.cc:463</a> (0.30.0)</span>\n</li>\n<li id=\"cite_note-10\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-10\">↑</a></span> <span class=\"reference-text\"><a rel=\"nofollow\" class=\"external text\" href=\"https://github.com/crawl/crawl/blob/0.30.0/crawl-ref/source/spl-cast.cc#L466\">spl-cast.cc:466</a> (0.30.0)</span>\n</li>\n<li id=\"cite_note-11\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-11\">↑</a></span> <span class=\"reference-text\"><a rel=\"nofollow\" class=\"external text\" href=\"https://github.com/crawl/crawl/blob/0.30.0/crawl-ref/source/spl-cast.cc#L335\">spl-cast.cc:335</a> (0.30.0)</span>\n</li>\n<li id=\"cite_note-12\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-12\">↑</a></span> <span class=\"reference-text\"><a rel=\"nofollow\" class=\"external text\" href=\"https://github.com/crawl/crawl/blob/0.30.0/crawl-ref/source/spl-cast.cc#L475\">spl-cast.cc:475</a> (0.30.0)</span>\n</li>\n<li id=\"cite_note-13\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-13\">↑</a></span> <span class=\"reference-text\"><a rel=\"nofollow\" class=\"external text\" href=\"https://github.com/crawl/crawl/blob/0.30.0/crawl-ref/source/spl-cast.cc#L2533\">spl-cast.cc:2533</a> (0.30.0)</span>\n</li>\n</ol></div>\n\n<!-- \nNewPP limit report\nCached time: 20240916103335\nCache expiry: 86400\nDynamic content: false\n[SMW] In‐text annotation parser time: 0.001 seconds\nCPU time usage: 0.156 seconds\nReal time usage: 0.209 seconds\nPreprocessor visited node count: 518/1000000\nPreprocessor generated node count: 1338/1000000\nPost‐expand include size: 2341/2097152 bytes\nTemplate argument size: 517/2097152 bytes\nHighest expansion depth: 4/40\nExpensive parser function count: 0/100\nLua time usage: 0.000s\nLua virtual size: 8.02 MB / 50 MB\nLua estimated memory usage: 0 bytes\n-->\n<!--\nTransclusion expansion time report (%,ms,calls,template)\n100.00%  106.134      1 -total\n 43.93%   46.629      1 Template:Version031\n 42.27%   44.860      1 Template:Version\n  9.71%   10.304     13 Template:Source_ref\n-->\n</div>\n<!-- Saved in parser cache with key crawl_wiki-crawl_:pcache:idhash:550-0!canonical and timestamp 20240916103334 and revision id 80120\n -->\n</div>\t\t\t\t\t<div class=\"printfooter\">\n\t\t\t\t\t\tRetrieved from \"<a dir=\"ltr\" href=\"http://crawl.chaosforge.org/index.php?title=Spell_Success&amp;oldid=80120\">http://crawl.chaosforge.org/index.php?title=Spell_Success&amp;oldid=80120</a>\"\t\t\t\t\t</div>\n\t\t\t\t<div id=\"catlinks\" class=\"catlinks\" data-mw=\"interface\"><div id=\"mw-normal-catlinks\" class=\"mw-normal-catlinks\"><a href=\"/Special:Categories\" title=\"Special:Categories\">Categories</a>: <ul><li><a href=\"/Category:0.31_articles\" title=\"Category:0.31 articles\">0.31 articles</a></li><li><a href=\"/Category:Magic\" title=\"Category:Magic\">Magic</a></li></ul></div></div>\t\t\t\t<div class=\"visualClear\"></div>\n\t\t\t\t\t\t\t</div>\n\t\t</div>\n\t\t<div id=\"mw-navigation\">\n\t\t\t<h2>Navigation menu</h2>\n\n\t\t\t<div id=\"mw-head\">\n\t\t\t\t\t\t\t\t\t<div id=\"p-personal\" role=\"navigation\" class=\"\" aria-labelledby=\"p-personal-label\">\n\t\t\t\t\t\t<h3 id=\"p-personal-label\">Personal tools</h3>\n\t\t\t\t\t\t<ul>\n\t\t\t\t\t\t\t<li id=\"pt-login\"><a href=\"/index.php?title=Special:UserLogin&amp;returnto=Spell+Success\" title=\"You are encouraged to log in; however, it is not mandatory [o]\" accesskey=\"o\">Log in</a></li>\t\t\t\t\t\t</ul>\n\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div id=\"left-navigation\">\n\t\t\t\t\t\t\t\t\t\t<div id=\"p-namespaces\" role=\"navigation\" class=\"vectorTabs\" aria-labelledby=\"p-namespaces-label\">\n\t\t\t\t\t\t<h3 id=\"p-namespaces-label\">Namespaces</h3>\n\t\t\t\t\t\t<ul>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<li id=\"ca-nstab-main\" class=\"selected\"><span><a href=\"/Spell_Success\" title=\"View the content page [c]\" accesskey=\"c\">Page</a></span></li>\n\t\t\t\t\t\t\t<li id=\"ca-talk\"><span><a href=\"/Talk:Spell_Success\" rel=\"discussion\" title=\"Discussion about the content page [t]\" accesskey=\"t\">Discussion</a></span></li>\n\t\t\t\t\t\t</ul>\n\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<div id=\"p-variants\" role=\"navigation\" class=\"vectorMenu emptyPortlet\" aria-labelledby=\"p-variants-label\">\n\t\t\t\t\t\t\t\t\t\t\t\t<h3 id=\"p-variants-label\">\n\t\t\t\t\t\t\t<span>Variants</span>\n\t\t\t\t\t\t</h3>\n\n\t\t\t\t\t\t<div class=\"menu\">\n\t\t\t\t\t\t\t<ul>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t<div id=\"right-navigation\">\n\t\t\t\t\t\t\t\t\t\t<div id=\"p-views\" role=\"navigation\" class=\"vectorTabs\" aria-labelledby=\"p-views-label\">\n\t\t\t\t\t\t<h3 id=\"p-views-label\">Views</h3>\n\t\t\t\t\t\t<ul>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<li id=\"ca-view\" class=\"selected\"><span><a href=\"/Spell_Success\">Read</a></span></li>\n\t\t\t\t\t\t\t<li id=\"ca-viewsource\"><span><a href=\"/index.php?title=Spell_Success&amp;action=edit\" title=\"This page is protected.&#10;You can view its source [e]\" accesskey=\"e\">View source</a></span></li>\n\t\t\t\t\t\t\t<li id=\"ca-history\" class=\"collapsible\"><span><a href=\"/index.php?title=Spell_Success&amp;action=history\" title=\"Past revisions of this page [h]\" accesskey=\"h\">View history</a></span></li>\n\t\t\t\t\t\t</ul>\n\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<div id=\"p-cactions\" role=\"navigation\" class=\"vectorMenu emptyPortlet\" aria-labelledby=\"p-cactions-label\">\n\t\t\t\t\t\t<h3 id=\"p-cactions-label\"><span>More</span></h3>\n\n\t\t\t\t\t\t<div class=\"menu\">\n\t\t\t\t\t\t\t<ul>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<div id=\"p-search\" role=\"search\">\n\t\t\t\t\t\t<h3>\n\t\t\t\t\t\t\t<label for=\"searchInput\">Search</label>\n\t\t\t\t\t\t</h3>\n\n\t\t\t\t\t\t<form action=\"/index.php\" id=\"searchform\">\n\t\t\t\t\t\t\t<div id=\"simpleSearch\">\n\t\t\t\t\t\t\t<input type=\"search\" name=\"search\" placeholder=\"Search CrawlWiki\" title=\"Search CrawlWiki [f]\" accesskey=\"f\" id=\"searchInput\"/><input type=\"hidden\" value=\"Special:Search\" name=\"title\"/><input type=\"submit\" name=\"fulltext\" value=\"Search\" title=\"Search the pages for this text\" id=\"mw-searchButton\" class=\"searchButton mw-fallbackSearchButton\"/><input type=\"submit\" name=\"go\" value=\"Go\" title=\"Go to a page with this exact name if it exists\" id=\"searchButton\" class=\"searchButton\"/>\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</form>\n\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div id=\"mw-panel\">\n\t\t\t\t<div id=\"p-logo\" role=\"banner\"><a class=\"mw-wiki-logo\" href=\"/Crawl_Wiki\"  title=\"Visit the main page\"></a></div>\n\t\t\t\t\t\t<div class=\"portal\" role=\"navigation\" id='p-navigation' aria-labelledby='p-navigation-label'>\n\t\t\t<h3 id='p-navigation-label'>Navigation</h3>\n\n\t\t\t<div class=\"body\">\n\t\t\t\t\t\t\t\t\t<ul>\n\t\t\t\t\t\t<li id=\"n-mainpage-description\"><a href=\"/Crawl_Wiki\" title=\"Visit the main page [z]\" accesskey=\"z\">Main page</a></li><li id=\"n-recentchanges\"><a href=\"/Special:RecentChanges\" title=\"A list of recent changes in the wiki [r]\" accesskey=\"r\">Recent changes</a></li><li id=\"n-randompage\"><a href=\"/Special:Random\" title=\"Load a random page [x]\" accesskey=\"x\">Random page</a></li><li id=\"n-help\"><a href=\"https://www.mediawiki.org/wiki/Special:MyLanguage/Help:Contents\" title=\"The place to find out\">Help</a></li>\t\t\t\t\t</ul>\n\t\t\t\t\t\t\t</div>\n\t\t</div>\n\t\t\t<div class=\"portal\" role=\"navigation\" id='p-tb' aria-labelledby='p-tb-label'>\n\t\t\t<h3 id='p-tb-label'>Tools</h3>\n\n\t\t\t<div class=\"body\">\n\t\t\t\t\t\t\t\t\t<ul>\n\t\t\t\t\t\t<li id=\"t-whatlinkshere\"><a href=\"/Special:WhatLinksHere/Spell_Success\" title=\"A list of all wiki pages that link here [j]\" accesskey=\"j\">What links here</a></li><li id=\"t-recentchangeslinked\"><a href=\"/Special:RecentChangesLinked/Spell_Success\" rel=\"nofollow\" title=\"Recent changes in pages linked from this page [k]\" accesskey=\"k\">Related changes</a></li><li id=\"t-specialpages\"><a href=\"/Special:SpecialPages\" title=\"A list of all special pages [q]\" accesskey=\"q\">Special pages</a></li><li id=\"t-print\"><a href=\"/index.php?title=Spell_Success&amp;printable=yes\" rel=\"alternate\" title=\"Printable version of this page [p]\" accesskey=\"p\">Printable version</a></li><li id=\"t-permalink\"><a href=\"/index.php?title=Spell_Success&amp;oldid=80120\" title=\"Permanent link to this revision of the page\">Permanent link</a></li><li id=\"t-info\"><a href=\"/index.php?title=Spell_Success&amp;action=info\" title=\"More information about this page\">Page information</a></li><li id=\"t-smwbrowselink\"><a href=\"/Special:Browse/:Spell-5FSuccess\" rel=\"smw-browse\">Browse properties</a></li>\t\t\t\t\t</ul>\n\t\t\t\t\t\t\t</div>\n\t\t</div>\n\t\t\t\t</div>\n\t\t</div>\n\t\t<div id=\"footer\" role=\"contentinfo\">\n\t\t\t\t\t\t\t<ul id=\"footer-info\">\n\t\t\t\t\t\t\t\t\t\t\t<li id=\"footer-info-lastmod\"> This page was last edited on 27 March 2024, at 06:01.</li>\n\t\t\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t\t<ul id=\"footer-places\">\n\t\t\t\t\t\t\t\t\t\t\t<li id=\"footer-places-privacy\"><a href=\"/CrawlWiki:Privacy_policy\" title=\"CrawlWiki:Privacy policy\">Privacy policy</a></li>\n\t\t\t\t\t\t\t\t\t\t\t<li id=\"footer-places-about\"><a href=\"/CrawlWiki:About\" title=\"CrawlWiki:About\">About CrawlWiki</a></li>\n\t\t\t\t\t\t\t\t\t\t\t<li id=\"footer-places-disclaimer\"><a href=\"/CrawlWiki:General_disclaimer\" title=\"CrawlWiki:General disclaimer\">Disclaimers</a></li>\n\t\t\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t\t\t\t\t<ul id=\"footer-icons\" class=\"noprint\">\n\t\t\t\t\t\t\t\t\t\t\t<li id=\"footer-poweredbyico\">\n\t\t\t\t\t\t\t<a href=\"//www.mediawiki.org/\"><img src=\"/resources/assets/poweredby_mediawiki_88x31.png\" alt=\"Powered by MediaWiki\" srcset=\"/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /resources/assets/poweredby_mediawiki_176x62.png 2x\" width=\"88\" height=\"31\"/></a><a href=\"https://www.semantic-mediawiki.org/wiki/Semantic_MediaWiki\"><img src=\"/extensions/SemanticMediaWiki/includes/../res/images/smw_button.png\" alt=\"Powered by Semantic MediaWiki\" width=\"88\" height=\"31\"/></a>\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t<div style=\"clear:both\"></div>\n\t\t</div>\n\t\t<script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({\"wgPageParseReport\":{\"smw\":{\"limitreport-intext-parsertime\":0.001},\"limitreport\":{\"cputime\":\"0.156\",\"walltime\":\"0.209\",\"ppvisitednodes\":{\"value\":518,\"limit\":1000000},\"ppgeneratednodes\":{\"value\":1338,\"limit\":1000000},\"postexpandincludesize\":{\"value\":2341,\"limit\":2097152},\"templateargumentsize\":{\"value\":517,\"limit\":2097152},\"expansiondepth\":{\"value\":4,\"limit\":40},\"expensivefunctioncount\":{\"value\":0,\"limit\":100},\"timingprofile\":[\"100.00%  106.134      1 -total\",\" 43.93%   46.629      1 Template:Version031\",\" 42.27%   44.860      1 Template:Version\",\"  9.71%   10.304     13 Template:Source_ref\"]},\"cachereport\":{\"timestamp\":\"20240916103335\",\"ttl\":86400,\"transientcontent\":false}}});});</script><script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({\"wgBackendResponseTime\":578});});</script>\n\t</body>\n</html>\n","rawPage":"{{version031}}\n{| style=\"float: right;\"\n| __TOC__\n|}\n\n'''Spell success''' is the rate at which casting a [[spell]] can be expected to succeed.\nSpell success rate is determined by a complex combination of:\n\n# Spell level\n# Spell-related skills, [[Intelligence]]\n# Penalties from [[body armour]] and [[shields]] (mitigated by [[Armour (skill)|Armour skill]] / [[Shields (skill)|Shields skill]])\n# Modifiers like [[Wizardry]] and [[Good_mutations#Wild_Magic|Wild Magic]]\n\n==Base Chance==\nThe source code talks in terms of chance of ''failure'', not success. Therefore, we want the spellFailure chance to be as low as possible - in fact, to reach a 0% failure rate, your chance to fail has to be '''negative'''. More on that below.\n\nThe base failure before ''any'' modifiers is as follows:<ref>{{source ref|0.30.0|spl-cast.cc|406}}</ref>\n\n  spellFailure = 60\n               - [6 * spell_skills]\n               - [2 * Intelligence]\n               + Spell difficulty\n               + Encumbrance penalties\n\n* 60 is an arbitrary base chance of failure.\n* Increasing intelligence and spell skills (skills respective to the spell ''and'' [[Spellcasting]]) will decrease failure.\n* Higher level spells are more difficult, wearing armour/shields make it more difficult.\n\n=== Spell skills ===\n\"Spell_skills\" takes into account Spellcasting and an average of a spell's schools (e.g. a Conjurations / Fire spell will take the average of the [[Conjurations]] skill and [[Fire Magic]] skill). This is calculated with the following equation:<ref>{{source ref|0.30.0|spl-cast.cc|413}}</ref>\n<ref>{{source ref|0.30.0|spl-cast.cc|377}}</ref>\n  spell_skills = [Spellcasting / 2] + [Average(Skill_level) * 2]\n\n=== Spell difficulty ===\nHigher level spells are more difficult. Each level of spell adds a number to your spell failure rate:<ref>{{source ref|0.30.0|spl-cast.cc|422}}</ref>\n\n  spellDifficulty =   3 (level 1)\n                     15 (level 2)   (+12)\n                     35 (level 3)   (+20)\n                     70 (level 4)   (+35)\n                    100 (level 5)   (+30)\n                    150 (level 6)   (+50)\n                    200 (level 7)   (+50)\n                    260 (level 8)   (+60)\n                    340 (level 9)   (+80)\n\n=== Encumbrance penalties ===\n\nBoth Armour and Shield penalties for spells are derived from their [[EV]] penalties. First, calculate the ev penalty, then calculate the spell penalty. Armour and Shields do not influence each other.\n\n'''Armour'''<ref>{{source ref|0.30.0|player.cc|5723}}</ref><ref>{{source ref|0.30.0|player.cc|2131}}</ref>\n\n  ev penalty = 1/225 * [[encumbrance]]^2 * (90 - 2 * [[Armour (skill)|armour_skill]]) / ([[str]] + 3)\n  spell penalty = 19 * ev penalty\n\n'''Shield'''<ref>{{source ref|0.30.0|player.cc|5739}}</ref><ref>{{source ref|0.30.0|player.cc|2134}}</ref>\n\n  ev penalty = 2/5 * [[Shields#EV_Penalty|encumbrance]]^2 / (5 + str) * (27 - [[Shields_(skill)|shield_skill]]) / 27\n  spell penalty = 19 * ev penalty\n\n== Step down ==\nAt this point, the spell failure is put through a complicated post-processing curve:<ref>{{source ref|0.30.0|spl-cast.cc|463}}</ref>\n\n (x^3 + 426x^2 + 82670x + 6983254) / 262144 IF spellFailure < 43\n\nThis replicates a step-down curve:\n[[File:Spell_success_stepdown.png|thumb|center|800px|x-axis = spellFailure, y-axis = Raw Failure Rate]]\n\nThis curve has the following points:\n{| class=\"prettytable\" style=\"text-align: center\" border=1\n|-\n!SpellFailure!!Raw fail chance\n|-\n|43 || 43%\n|-\n|25 || 36.6%\n|-\n|0 || 27.7%\n|-\n|<nowiki>-</nowiki>50 || 15.5%\n|-\n|<nowiki>-</nowiki>72 || 10%\n|-\n|<nowiki>-</nowiki>100 || 8.5%\n|-\n|<nowiki>-</nowiki>173 || 0% \n|-\n|}\n\n==Modifiers==\nThe following modifiers are added after the STEPPED DOWN failure rates above. However, it is still considered the ''raw spell failure chance'', which is adjusted by a sigmoid function later.<ref>{{source ref|0.30.0|spl-cast.cc|466}}</ref>\n\n'''Positive (+spell failure):'''\n*[[Wild Magic (mutation)|Wild Magic]]: +4% per level\n*Disrupted Magic (-Wiz) [[Ru|sacrifice]]: +4% per level\n*[[Orb]] of [[energy]]: +10%\n**[[Crystal ball of Wucad Mu]]: +10%\n*[[Vertigo]]: +7%\n\n'''Negative (-spell failure):'''\n*[[Subdued Magic]]: -2% per level\n*[[Wizardry]]: multiplied by ×<code>6 / (7 + sources)</code>%, assuming you have at least one source. (×75% for Wiz x1, ×66.6% for Wiz x2, and so on.)\n*[[Vehumet]]: multiplied by ×66.6%.<ref>{{source ref|0.30.0|spl-cast.cc|335}}</ref> (Note: this is not considered a source of wizardry, but it multiplicatively stacks with wizardry.)\n\nThe wizardry and Vehumet multipliers are applied after all others.<ref>{{source ref|0.30.0|spl-cast.cc|475}}</ref>\n\nAfter all modifiers have applied, you will get a cumulative ''raw spell failure chance''. This is converted into the final success via the function below.\n\n==Final Step==\nIn short, the game doesn't compare your raw failure chance with a number from 0 to 99. Instead, it compares the raw failure to the sum of three numbers divided by three.<ref>{{source ref|0.30.0|spl-cast.cc|2533}}</ref>\n (1d101 + 1d101 + 1d100 - 3)/3 < fail chance\n\nThis is equivalent to applying this transformation to the chance of failure:\n\n[[Image:Spell_success_transformation.png]]\n\nThis sigmoid function makes it more difficult to decrease your failure rate when it is high or low, but it will go down very quickly when it is in the middle. For raw failures below 33%, one can use this formula:\n\n  N                 = (raw_failure_rate) * 3\n  Real Failure Rate = N * (N+1) * (N+2) / 6 / 101 / 101 (in unit of %)\n\nThis can be tabulated for usefulness.\n\n{| class=\"prettytable\" style=\"text-align: center\" border=1\n|-\n!SpellFailure Req'd*!!Raw fail chance!!Actual fail chance\n|-\n|13||32%||14.9%\n|-\n|7||30%||12.3%\n|-\n|1||28%||10.0%\n|-\n|<nowiki>-</nowiki>6||26%||8.1%\n|-\n|<nowiki>-</nowiki>12||24%||6.4%\n|-\n|<nowiki>-</nowiki>20||22%||4.9%\n|-\n|<nowiki>-</nowiki>28||20%||3.7%\n|-\n|<nowiki>-</nowiki>37||18%||2.7%\n|-\n|<nowiki>-</nowiki>47||16%||1.9%\n|-\n|<nowiki>-</nowiki>58||14%||1.3%\n|-\n|<nowiki>-</nowiki>71||12%||0.8%\n|-\n|}\n<nowiki>*</nowiki>SpellFailure required to reach a given raw fail chance, ''assuming you don't have any modifiers like [[wizardry]]''. E.g. if you have wizardry x1, having 1 SpellFailure = (28% * 0.75) raw failure = 21% raw failure.\n\n== Strategy ==\nIt is debatable whether these formulae are of any practical use during a game.\n\nIt may be nice to know a few things from a strategic point of view. \n*High level spells take a massive amount of XP to train, and it can be useful to know how many levels you'd need. \n*You can quantize your level of armour [[encumbrance]]. A caster could say \"a set of [[fire dragon scales]] gives a spell penalty equal to 6 levels of each spell school\". Then, you could determine if wearing FDS is worth it, both short-term (\"can I cast a spell in this ''right now''?\") and long-term (\"can I cast a spell in this ''when I reach Zot''?\").\n*You can calculate the relative value of a skill. For example, you can see when a level of <Spell School> would be more valuable than a level of Armour skill, or when a point of [[strength]] is worth more than a point of [[intelligence]].\n\nOf course, this isn't necessary. You can derive most (if not all) of this information by just checking your spell failure in game. If you wear a pierce of armour, and determine that your spell failure is unacceptable, then don't wear that armour - no need to calculate it! After you trained your skill a bit, you can wear a desired armour again, and see if it's any better.\n\n==Analysis==\n\n===Skill Req'd to Cast L9 Spells===\nSay you wanted to [[Fire Storm]] reliably. For sake of example, we're trying to reach a 10% failure rate. You can look at the table above: to get a 10% actual failure rate, you'd need 28% raw failure. If you have no wizardry, 28% raw failure = 1 SpellFailure.\n\nUsing the [[#Base Chance|SpellFailure]] calculations at the top of the page, you can calculate what's needed to get to 1 SpellFailure. For this example, assume you have 30 intelligence, no wizardry, and 0 encumbrance from armour/shields.\n\n 60 (base failure)\n + 340 (level 9 spell)\n - 6 * [0.5 * spellcasting + 2 * avg_skill] (spell skills)\n - 30 * 2 (30 intelligence)\n + 0 (encumbrance)<br><br>= 340 - (3 * spellcasting) - (12 * avg_skill) = SpellFailure\n\nWe want a SpellFailure = 1, so <code>340 - (3 * spellcasting) - (12 * avg_skill) = 1</code>. So if you had an Spellcasting skill of 14, you'd need 24.75 in avg_skill - that is, Fire Magic and Conjurations. If you had a Spellcasting skill of 22.7, you'd need 22.7 in Fire Magic and Conjurations.\n\nWizardry reduces your raw failure rate by x75% for 1 stack, x66% for 2 stacks, etc.. So if you had wizardry x1, you'd need a (28 / .75) = 37.3% raw failure before wizardry (which, in turn, equals 29.21 SpellFailure). The same calculations can be done for other amounts of wizardry.\n\nSo, assuming you have 30 int and 0 encumbrance, the following skills would reach the desired 10% actual failure rate:\n*'''No Wizardry''': {14 Spellcasting, 24.75 avg_skill}, {22.7 Spellcasting, 22.7 avg_skill}\n*'''Wizardry x1''': {14 Spellcasting, 22.49 avg_skill}, {20.7 Spellcasting, 20.7 avg_skill}\n*'''Wizardry x2''' / '''Vehumet''': {14 Spellcasting, 21.5 avg_skill}, {20 Spellcasting, 20 avg_skill}\n*'''Vehumet + Wizardry x1''': {14 Spellcasting, 20.2 avg_skill}, {18.9 Spellcasting, 18.9 avg_skill}\n\nThese numbers apply to any level 9 spell in the game, not just Fire Storm... again, ''assuming you have 30 int / 0 encumbrance''. If you're wearing [[swamp dragon scales]] and a [[kite shield]], for instance, it'll take more skill to cast. Change the values of spell level, intelligence, encumbrance as you see fit.\n\n===Measuring Encumbrance===\nThe effect of encumbrance on your actual % to fail is non-linear. However, it can be measured by \"levels of a spell school needed to compensate\".\n\n'''Armour'''\n\nBody armour increases SpellFailure by <code>19/225 * encumbrance^2 * (90 - 2 * Armour) / (str + 3)</code>. Having 1 level of every spell school (except Spellcasting) reduces SpellFailure by 12. Therefore, armour encumbrance can be measured in terms of skill levels, using the formula [SpellFailure Increase] / 12.\n\nAs an example: say you have 6 strength, are wearing [[troll leather armour]] (encumbrance = 4), and have 0 Armour skill. Your SpellFailure would be <code>19/225 * 4^2 * (90 - 0) / (6 + 3)</code> = 13.51 SpellFailure, or 1.13 levels in each skill. That really isn't much in the grand scheme of things. By the time you get troll leather armour, you can negate a ~1 level penalty.\n\nFor reference:\n*10 strength, [[leather armour]], 0 Armour skill: -0.78 levels in each skill\n*10 strength, [[ring mail]] or [[swamp dragon scales]], 5 Armour skill:  -2.12 levels in each skill\n*10 strength, [[fire dragon scales]], 5 Armour skill: -5.24 levels in each skill\n\nRemember that things change based on strength and skill. Also remember that you can train Armour skill to lower the penalty (see [[#Armour skill vs Spell skill|Armour skill vs Spell skill]] for more).\n\n'''Shields'''\n\nShield increases SpellFailure by <code>38/5 * encumbrance^2 / (str + 5) * (27 - Shields)/27</code>. Using the same method as body armour, as seen above, you can get a number for shield encumbrance, too. Relative to armour, strength matters a little less, but Shields skill matters more.\n\nIf you have 6 strength, a [[buckler]] (encumbrance = 5), and have 0 Shields skill, SpellFailure equals <code>38/5 * 5^2 / (6 + 5) * 27/27</code> = 17.27, or 1.44 levels in each skill. A [[kite shield]] would be 4x that, a [[tower shield]] would be 9x that.\n\n===Armour skill vs Spell skill===\n*Armour skill reduces SpellFailure by <code>-Armour * 38/225 * encumbrance^2 / (str + 3)</code>.\n*Having 1 of every spell school (except Spellcasting) reduces SpellFailure by 12. Divide by number of spell schools if needed.\n*Therefore, each level in Armour is worth <code>19/1350 * encumbrance^2 / (str + 3)</code>, or roughly <code>1/71 * encumbrance^2 / (str + 3)</code>, levels in each spell school. \n\nFor example, if you have 11 strength and are wearing [[fire dragon scales]], the equation <code>1/71 * 11^2 / 14</code> = 0.122, or 8.21 Armour : 1 in each spell school. If you have a dual-school spell, like [[Fireball]], 4.1 Armour skill = 1 Earth Magic OR 1 Conjurations, while 8.21 Armour = 1 Earth AND Conjurations.\n\nOf course, this '''ONLY''' takes into account spell failure. Training Armour skill increases your defenses; training spell schools increases your power.\n\n===Strength vs Intelligence===\n*For a given change in strength 'x', strength reduces both armour and shield encumbrance by:\n**Armour: <code>(1/<str+3> - 1/<str+x+3>) * 19/225 * encumbrance^2 * (90 - 2 * Armour)</code>\n**Shield: <code>(1/<str+5> - 1/<str+x+5>) * 38/5 * encumbrance^2 * (27 - Shields)/27</code>\n*Intelligence reduces SpellFailure by 2 per point.\n\nSay you have 11 strength, fire dragon scales, and 0 Armour skill. On level up, you have a choice of 2 str or 2 int. The impact of +2 str is equal to <code>(1/14 - 1/16) * 19/225 * 11^2 * (90 - 0)</code> = 8.21 SpellFailure, greater than 2*2 = 4 SpellFailure from intelligence.\n\nIf this 11 strength character is also wearing a [[kite shield]], with 9 Shields skill, +2 strength would also give <code>(1/16 - 1/18) * 38/5 * 10^2 * 18/27</code> = 3.52 SpellFailure.\n\nOf course, intelligence also increases [[spell power]], while strength reduces [[EV]] penalties.\n\n==See also==\n*[[Spell power]]\n*[[Miscast effect]]\n\n==History==\n*Prior to [[0.31]], the raw failure rate multiplier from wizardry/Vehumet was capped at 50%. Therefore, you could only have a maximum of 5 stacks of wizardry, or 1 stack of wizardry with Vehumet's bonus. Also, some [[transmutations]] increased your spell failure: [[Spider Form]] (+10%) and [[Blade Hands (spell)|Blade Hands]] (+20%).\n*Prior to [[0.22]], spell_schools went through a stepdown, <code>50 * log2(1 + spell_schools/50)</code>, which penalized the caster if <code>(Spellcasting/2) + (2* AvgSpellSchool) > 50</code>. However, spellFailure for level 9 spells was 330 instead of 340.\n*Prior to [[0.20]], the [[#Step down|Step down]] function was different, relying on breakpoints rather than a polynomial. Also, more breakpoints existed elsewhere in the spell failure calculation.\n\n==References==\n<references/>\n\n[[Category:Magic]]"}