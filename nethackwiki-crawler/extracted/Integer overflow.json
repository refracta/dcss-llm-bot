{"title":"Integer overflow","url":"https://nethackwiki.com/wiki/Integer_overflow","type":"markdown","data":"[![Wikipedia](/images/thumb/f/f8/Fair-use-wikipedia-logo.png/50px-Fair-use-wikipedia-logo.png)](/wiki/File:Fair-use-wikipedia-logo.png \"Wikipedia\")\n\n[Wikipedia](http://en.wikipedia.org/wiki/Main_Page \"wikipedia:Main Page\") has an article about:\n\n***[Integer overflow](http://en.wikipedia.org/wiki/Integer_overflow \"wikipedia:Integer overflow\")***\n\n**Integer overflow** occurs when an integer value exceeds the range of its data type.\n\nFor a [signed variable](/wiki/Signed_variable \"Signed variable\"), the exact behavior is [undefined behavior](http://en.wikipedia.org/wiki/undefined_behavior \"wikipedia:undefined behavior\") by the C standard. Often what happens, due to [two's complement arithmetic](http://en.wikipedia.org/wiki/Two%27s_complement \"wikipedia:Two's complement\"), is that the variable wraps to the opposite end of the range: a negative value just beyond the range would become a large positive value, and vice versa. For an unsigned variable, the C standard does define the exact behavior: an unsigned variable that exceeds its capacity becomes a small positive value, or zero, and subtracting too much from a small unsigned variable produces a large value.\n\n*[NetHack](/wiki/NetHack \"NetHack\")* protects most variables against integer overflow, both signed and unsigned - however, it is possible to find ways to avoid these limits in [wizard mode](/wiki/Wizard_mode \"Wizard mode\"). For example, in wizard mode, the character might wish for one billion dwarf corpses, producing an object stack whose total weight may appear to be negative (depending on details of the C implementation used to run NetHack).\n\nAny case where an ordinary game (not in wizard mode) can produce an integer overflow is likely to be a [software bug](/wiki/Software_bug \"Software bug\").\n\n[ ]\n\n## Contents\n\n- [1 Current overflows](#Current_overflows)\n  - [1.1 Wrapping the turn counter](#Wrapping_the_turn_counter)\n- [2 History](#History)\n- [3 References](#References)\n\n## Current overflows\n\n### Wrapping the turn counter\n\nIn NetHack 3.6.7 and earlier versions, the turn counter has no protection against overflow.[\\[1\\]](#cite_note-1)\n\n[NAO](/wiki/NAO \"NAO\") reports one game that ended with less than 0 turns played.[\\[2\\]](#cite_note-2). There are no ascended games with 1 turn or any number of turns less than 2000.\n\nSince that time, NAO switched from 32-bit binaries to 64-bit binaries, as evidenced by several games recorded with scores higher than 2,147,483,647. Nowadays, wrapping the turn counter on an NAO game would take 4 billion times as long as previously.\n\n*The following information pertains to an upcoming version ([NetHack 3.7.0](/wiki/NetHack_3.7.0 \"NetHack 3.7.0\")). If this version is now released, please verify that it is still accurate, then update the page to incorporate this information.*\n\nFor games running over 100000 turns, [prayer](/wiki/Prayer \"Prayer\") timeout increases by 1 every 100 turns - this is implemented to prevent denial-of-service attacks against [public servers](/wiki/Public_server \"Public server\"). If a game runs over one billion turns, it ends immediately in an [escape](/wiki/Escaping_the_dungeon \"Escaping the dungeon\"):\n\n- The dungeon capitulates.\n\n## History\n\nIn [NetHack 3.4.3](/wiki/NetHack_3.4.3 \"NetHack 3.4.3\") and previous versions, including some variants based on those versions, cases of integer overflow that are fixed in [NetHack 3.6.0](/wiki/NetHack_3.6.0 \"NetHack 3.6.0\") include:\n\n- [Negative gold](/wiki/Negative_gold \"Negative gold\")\n- Extreme [intrinsic protection](/wiki/Intrinsic_protection \"Intrinsic protection\") from [prayer](/wiki/Prayer \"Prayer\")\n- Extreme bonuses to hit or to damage from [eating jewelry](/wiki/Eating_jewelry \"Eating jewelry\")\n\nWrapping the score[\\[3\\]](#cite_note-3)[\\[4\\]](#cite_note-4) is supposed to be fixed, but the fix relies on signed integer overflow, which is undefined behaviour.[\\[5\\]](#cite_note-5)\n\n## References\n\n1. [↑](#cite_ref-1) [src/allmain.c in NetHack 3.6.7, line 172](https://github.com/NetHack/NetHack/blob/NetHack-3.6.7_Released/src/allmain.c#L172)\n2. [↑](#cite_ref-2) <https://s3.amazonaws.com/altorg/dumplog/Khaos/1291644901.nh343.txt>\n3. [↑](#cite_ref-3) NAO game by ctaboir on 2006-10-03 with score -2,147,474,899; dumplog not available\n4. [↑](#cite_ref-4) [NAO](/wiki/NAO \"NAO\") game by pug on 2007-11-12 with score -2,145,868,906; dumplog not available\n5. [↑](#cite_ref-5) [src/end.c in NetHack 3.6.7, line 19](https://github.com/NetHack/NetHack/blob/NetHack-3.6.7_Released/src/end.c#L19): *macro nowrap\\_add*\n\n[![This article has been updated to reflect NetHack 3.6.7. Click here for more information.](/images/f/f7/Nh367-icon.png)](/wiki/NetHackWiki:Next_version \"This article has been updated to reflect NetHack 3.6.7. Click here for more information.\")\n","html":"<!DOCTYPE html>\n<html class=\"client-nojs\" lang=\"en\" dir=\"ltr\">\n<head>\n<meta charset=\"UTF-8\"/>\n<title>Integer overflow - NetHack Wiki</title>\n<script>document.documentElement.className = document.documentElement.className.replace( /(^|\\s)client-nojs(\\s|$)/, \"$1client-js$2\" );</script>\n<script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({\"wgCanonicalNamespace\":\"\",\"wgCanonicalSpecialPageName\":false,\"wgNamespaceNumber\":0,\"wgPageName\":\"Integer_overflow\",\"wgTitle\":\"Integer overflow\",\"wgCurRevisionId\":174240,\"wgRevisionId\":174240,\"wgArticleId\":4429,\"wgIsArticle\":true,\"wgIsRedirect\":false,\"wgAction\":\"view\",\"wgUserName\":null,\"wgUserGroups\":[\"*\"],\"wgCategories\":[\"Upcoming\",\"Nethack-367 articles\",\"Development\"],\"wgBreakFrames\":false,\"wgPageContentLanguage\":\"en\",\"wgPageContentModel\":\"wikitext\",\"wgSeparatorTransformTable\":[\"\",\"\"],\"wgDigitTransformTable\":[\"\",\"\"],\"wgDefaultDateFormat\":\"dmy\",\"wgMonthNames\":[\"\",\"January\",\"February\",\"March\",\"April\",\"May\",\"June\",\"July\",\"August\",\"September\",\"October\",\"November\",\"December\"],\"wgMonthNamesShort\":[\"\",\"Jan\",\"Feb\",\"Mar\",\"Apr\",\"May\",\"Jun\",\"Jul\",\"Aug\",\"Sep\",\"Oct\",\"Nov\",\"Dec\"],\"wgRelevantPageName\":\"Integer_overflow\",\"wgRelevantArticleId\":4429,\"wgRequestId\":\"77e8e5d6f6465ef03cbd5e09\",\"wgCSPNonce\":false,\"wgIsProbablyEditable\":false,\"wgRelevantPageIsProbablyEditable\":false,\"wgRestrictionEdit\":[],\"wgRestrictionMove\":[],\"wgWikiEditorEnabledModules\":[],\"wgCategoryTreePageCategoryOptions\":\"{\\\"mode\\\":0,\\\"hideprefix\\\":20,\\\"showcount\\\":true,\\\"namespaces\\\":false}\"});mw.loader.state({\"site.styles\":\"ready\",\"noscript\":\"ready\",\"user.styles\":\"ready\",\"user\":\"ready\",\"user.options\":\"ready\",\"user.tokens\":\"loading\",\"ext.cite.styles\":\"ready\",\"mediawiki.legacy.shared\":\"ready\",\"mediawiki.legacy.commonPrint\":\"ready\",\"mediawiki.toc.styles\":\"ready\",\"mediawiki.skinning.interface\":\"ready\",\"skins.vector.styles\":\"ready\"});mw.loader.implement(\"user.tokens@0tffind\",function($,jQuery,require,module){/*@nomin*/mw.user.tokens.set({\"editToken\":\"+\\\\\",\"patrolToken\":\"+\\\\\",\"watchToken\":\"+\\\\\",\"csrfToken\":\"+\\\\\"});\n});RLPAGEMODULES=[\"ext.cite.a11y\",\"site\",\"mediawiki.page.startup\",\"mediawiki.user\",\"mediawiki.page.ready\",\"mediawiki.toc\",\"mediawiki.searchSuggest\",\"skins.vector.js\"];mw.loader.load(RLPAGEMODULES);});</script>\n<link rel=\"stylesheet\" href=\"/load.php?debug=false&amp;lang=en&amp;modules=ext.cite.styles%7Cmediawiki.legacy.commonPrint%2Cshared%7Cmediawiki.skinning.interface%7Cmediawiki.toc.styles%7Cskins.vector.styles&amp;only=styles&amp;skin=vector\"/>\n<script async=\"\" src=\"/load.php?debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=vector\"></script>\n<meta name=\"ResourceLoaderDynamicStyles\" content=\"\"/>\n<link rel=\"stylesheet\" href=\"/load.php?debug=false&amp;lang=en&amp;modules=site.styles&amp;only=styles&amp;skin=vector\"/>\n<meta name=\"generator\" content=\"MediaWiki 1.32.5\"/>\n<meta name=\"description\" content=\"Integer overflow occurs when an integer value exceeds the range of its data type.\"/>\n<link rel=\"image_src\" href=\"/images/6/65/Nethackwiki-logo.png\"/>\n<link rel=\"shortcut icon\" href=\"/images/6/64/Favicon.ico\"/>\n<link rel=\"search\" type=\"application/opensearchdescription+xml\" href=\"/opensearch_desc.php\" title=\"NetHackWiki\"/>\n<link rel=\"EditURI\" type=\"application/rsd+xml\" href=\"https://nethackwiki.com/api.php?action=rsd\"/>\n<link rel=\"canonical\" href=\"/wiki/Integer_overflow\"/>\n<!--[if lt IE 9]><script src=\"/load.php?debug=false&amp;lang=en&amp;modules=html5shiv&amp;only=scripts&amp;skin=vector&amp;sync=1\"></script><![endif]-->\n</head>\n<body class=\"mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Integer_overflow rootpage-Integer_overflow skin-vector action-view\">\t\t<div id=\"mw-page-base\" class=\"noprint\"></div>\n\t\t<div id=\"mw-head-base\" class=\"noprint\"></div>\n\t\t<div id=\"content\" class=\"mw-body\" role=\"main\">\n\t\t\t<a id=\"top\"></a>\n\t\t\t<div class=\"mw-indicators mw-body-content\">\n</div>\n<h1 id=\"firstHeading\" class=\"firstHeading\" lang=\"en\">Integer overflow</h1>\t\t\t<div id=\"bodyContent\" class=\"mw-body-content\">\n\t\t\t\t<div id=\"siteSub\" class=\"noprint\">From NetHackWiki</div>\t\t\t\t<div id=\"contentSub\"></div>\n\t\t\t\t<div id=\"jump-to-nav\"></div>\t\t\t\t<a class=\"mw-jump-link\" href=\"#mw-head\">Jump to navigation</a>\n\t\t\t\t<a class=\"mw-jump-link\" href=\"#p-search\">Jump to search</a>\n\t\t\t\t<div id=\"mw-content-text\" lang=\"en\" dir=\"ltr\" class=\"mw-content-ltr\"><div class=\"mw-parser-output\"><div class=\"noprint sidebox\">\n<div style=\"float: left;\"><div class=\"floatnone\"><a href=\"/wiki/File:Fair-use-wikipedia-logo.png\" class=\"image\" title=\"Wikipedia\"><img alt=\"Wikipedia\" src=\"/images/thumb/f/f8/Fair-use-wikipedia-logo.png/50px-Fair-use-wikipedia-logo.png\" width=\"50\" height=\"50\" srcset=\"/images/f/f8/Fair-use-wikipedia-logo.png 1.5x\" /></a></div></div>\n<div style=\"margin-left: 60px;\"><a href=\"http://en.wikipedia.org/wiki/Main_Page\" class=\"extiw\" title=\"wikipedia:Main Page\">Wikipedia</a> has an article about:\n<div style=\"margin-left: 10px;\"><i><b><a href=\"http://en.wikipedia.org/wiki/Integer_overflow\" class=\"extiw\" title=\"wikipedia:Integer overflow\">Integer overflow</a></b></i></div>\n</div>\n</div>\n<p><b>Integer overflow</b> occurs when an integer value exceeds the range of its data type.\n</p><p>For a <a href=\"/wiki/Signed_variable\" title=\"Signed variable\">signed variable</a>, the exact behavior is <a href=\"http://en.wikipedia.org/wiki/undefined_behavior\" class=\"extiw\" title=\"wikipedia:undefined behavior\">undefined behavior</a> by the C standard. Often what happens, due to <a href=\"http://en.wikipedia.org/wiki/Two%27s_complement\" class=\"extiw\" title=\"wikipedia:Two&#39;s complement\">two's complement arithmetic</a>, is that the variable wraps to the opposite end of the range: a negative value just beyond the range would become a large positive value, and vice versa. For an unsigned variable, the C standard does define the exact behavior: an unsigned variable that exceeds its capacity becomes a small positive value, or zero, and subtracting too much from a small unsigned variable produces a large value.\n</p><p><i><a href=\"/wiki/NetHack\" title=\"NetHack\">NetHack</a></i> protects most variables against integer overflow, both signed and unsigned - however, it is possible to find ways to avoid these limits in <a href=\"/wiki/Wizard_mode\" title=\"Wizard mode\">wizard mode</a>.  For example, in wizard mode, the character might wish for one billion dwarf corpses, producing an object stack whose total weight may appear to be negative (depending on details of the C implementation used to run NetHack).\n</p><p>Any case where an ordinary game (not in wizard mode) can produce an integer overflow is likely to be a <a href=\"/wiki/Software_bug\" title=\"Software bug\">software bug</a>.\n</p>\n<div id=\"toc\" class=\"toc\"><input type=\"checkbox\" role=\"button\" id=\"toctogglecheckbox\" class=\"toctogglecheckbox\" style=\"display:none\" /><div class=\"toctitle\" lang=\"en\" dir=\"ltr\"><h2>Contents</h2><span class=\"toctogglespan\"><label class=\"toctogglelabel\" for=\"toctogglecheckbox\"></label></span></div>\n<ul>\n<li class=\"toclevel-1 tocsection-1\"><a href=\"#Current_overflows\"><span class=\"tocnumber\">1</span> <span class=\"toctext\">Current overflows</span></a>\n<ul>\n<li class=\"toclevel-2 tocsection-2\"><a href=\"#Wrapping_the_turn_counter\"><span class=\"tocnumber\">1.1</span> <span class=\"toctext\">Wrapping the turn counter</span></a></li>\n</ul>\n</li>\n<li class=\"toclevel-1 tocsection-3\"><a href=\"#History\"><span class=\"tocnumber\">2</span> <span class=\"toctext\">History</span></a></li>\n<li class=\"toclevel-1 tocsection-4\"><a href=\"#References\"><span class=\"tocnumber\">3</span> <span class=\"toctext\">References</span></a></li>\n</ul>\n</div>\n\n<h2><span class=\"mw-headline\" id=\"Current_overflows\">Current overflows</span></h2>\n<h3><span class=\"mw-headline\" id=\"Wrapping_the_turn_counter\">Wrapping the turn counter</span></h3>\n<p>In NetHack 3.6.7 and earlier versions, the turn counter has no protection against overflow.<sup id=\"cite_ref-1\" class=\"reference\"><a href=\"#cite_note-1\">&#91;1&#93;</a></sup>\n</p><p><a href=\"/wiki/NAO\" class=\"mw-redirect\" title=\"NAO\">NAO</a> reports one game that ended with less than 0 turns played.<sup id=\"cite_ref-2\" class=\"reference\"><a href=\"#cite_note-2\">&#91;2&#93;</a></sup>. There are no ascended games with 1 turn or any number of turns less than 2000.\n</p><p>Since that time, NAO switched from 32-bit binaries to 64-bit binaries, as evidenced by several games recorded with scores higher than 2,147,483,647. Nowadays, wrapping the turn counter on an NAO game would take 4 billion times as long as previously.\n</p>\n<div class=\"upcoming\">\n<p><i>The following information pertains to an upcoming version (<a href=\"/wiki/NetHack_3.7.0\" title=\"NetHack 3.7.0\">NetHack 3.7.0</a>). If this version is now released, please verify that it is still accurate, then update the page to incorporate this information.</i>\n</p><p>For games running over 100000 turns, <a href=\"/wiki/Prayer\" title=\"Prayer\">prayer</a> timeout increases by 1 every 100 turns - this is implemented to prevent denial-of-service attacks against <a href=\"/wiki/Public_server\" title=\"Public server\">public servers</a>. If a game runs over one billion turns, it ends immediately in an <a href=\"/wiki/Escaping_the_dungeon\" title=\"Escaping the dungeon\">escape</a>:\n</p>\n<dl><dt><span id=\"The_dungeon_capitulates.\">The dungeon capitulates.</span></dt></dl></div>\n<h2><span class=\"mw-headline\" id=\"History\">History</span></h2>\n<p>In <a href=\"/wiki/NetHack_3.4.3\" title=\"NetHack 3.4.3\">NetHack 3.4.3</a> and previous versions, including some variants based on those versions, cases of integer overflow that are fixed in <a href=\"/wiki/NetHack_3.6.0\" title=\"NetHack 3.6.0\">NetHack 3.6.0</a> include:\n</p>\n<ul><li><a href=\"/wiki/Negative_gold\" title=\"Negative gold\">Negative gold</a></li>\n<li>Extreme <a href=\"/wiki/Intrinsic_protection\" title=\"Intrinsic protection\">intrinsic protection</a> from <a href=\"/wiki/Prayer\" title=\"Prayer\">prayer</a></li>\n<li>Extreme bonuses to hit or to damage from <a href=\"/wiki/Eating_jewelry\" title=\"Eating jewelry\">eating jewelry</a></li></ul>\n<p>Wrapping the score<sup id=\"cite_ref-3\" class=\"reference\"><a href=\"#cite_note-3\">&#91;3&#93;</a></sup><sup id=\"cite_ref-4\" class=\"reference\"><a href=\"#cite_note-4\">&#91;4&#93;</a></sup> is supposed to be fixed, but the fix relies on signed integer overflow, which is undefined behaviour.<sup id=\"cite_ref-5\" class=\"reference\"><a href=\"#cite_note-5\">&#91;5&#93;</a></sup>\n</p>\n<h2><span class=\"mw-headline\" id=\"References\">References</span></h2>\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-1\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-1\">↑</a></span> <span class=\"reference-text\"><a class=\"external text\" href=\"https://github.com/NetHack/NetHack/blob/NetHack-3.6.7_Released/src/allmain.c#L172\">src/allmain.c in NetHack 3.6.7, line 172</a>\n     </span>\n</li>\n<li id=\"cite_note-2\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-2\">↑</a></span> <span class=\"reference-text\"><a class=\"external free\" href=\"https://s3.amazonaws.com/altorg/dumplog/Khaos/1291644901.nh343.txt\">https://s3.amazonaws.com/altorg/dumplog/Khaos/1291644901.nh343.txt</a></span>\n</li>\n<li id=\"cite_note-3\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-3\">↑</a></span> <span class=\"reference-text\">NAO game by ctaboir on 2006-10-03 with score -2,147,474,899; dumplog not available</span>\n</li>\n<li id=\"cite_note-4\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-4\">↑</a></span> <span class=\"reference-text\"><a href=\"/wiki/NAO\" class=\"mw-redirect\" title=\"NAO\">NAO</a> game by pug on 2007-11-12 with score -2,145,868,906; dumplog not available</span>\n</li>\n<li id=\"cite_note-5\"><span class=\"mw-cite-backlink\"><a href=\"#cite_ref-5\">↑</a></span> <span class=\"reference-text\"><a class=\"external text\" href=\"https://github.com/NetHack/NetHack/blob/NetHack-3.6.7_Released/src/end.c#L19\">src/end.c in NetHack 3.6.7, line 19</a><span>:</span> <i>macro nowrap_add</i>\n     </span>\n</li>\n</ol></div>\n<div style=\"display:none; right:10px; padding-bottom: 17px\" class=\"metadata topicon nopopups\"><div style=\"margin-top: -10px\"><a href=\"/wiki/NetHackWiki:Next_version\" title=\"This article has been updated to reflect NetHack 3.6.7. Click here for more information.\"><img alt=\"This article has been updated to reflect NetHack 3.6.7. Click here for more information.\" src=\"/images/f/f7/Nh367-icon.png\" width=\"32\" height=\"32\" /></a></div></div>\n\n<!-- \nNewPP limit report\nCached time: 20240926184138\nCache expiry: 604800\nDynamic content: false\nCPU time usage: 0.026 seconds\nReal time usage: 0.032 seconds\nPreprocessor visited node count: 336/1000000\nPreprocessor generated node count: 1741/1000000\nPost‐expand include size: 3590/2097152 bytes\nTemplate argument size: 1045/2097152 bytes\nHighest expansion depth: 9/40\nExpensive parser function count: 0/100\nUnstrip recursion depth: 0/20\nUnstrip post‐expand size: 1841/5000000 bytes\n-->\n<!--\nTransclusion expansion time report (%,ms,calls,template)\n100.00%   20.800      1 -total\n 30.58%    6.360      2 Template:Refsrc\n 22.97%    4.777      1 Template:Nethack-367\n 18.89%    3.929      1 Template:Upcoming\n 16.26%    3.383      1 Template:Version_icon\n 12.65%    2.631      1 Template:Wikipedia\n 12.60%    2.620      1 Template:Message\n 12.54%    2.608      2 Template:Refsrc/link\n  9.84%    2.046      1 Template:Top_icon\n  6.02%    1.253      1 Template:Generic_project_link\n-->\n\n<!-- Saved in parser cache with key wikihackdb:pcache:idhash:4429-0!canonical and timestamp 20240926184138 and revision id 174240\n -->\n</div></div>\t\t\t\t\t<div class=\"printfooter\">\n\t\t\t\t\t\tRetrieved from \"<a dir=\"ltr\" href=\"https://nethackwiki.com/index.php?title=Integer_overflow&amp;oldid=174240\">https://nethackwiki.com/index.php?title=Integer_overflow&amp;oldid=174240</a>\"\t\t\t\t\t</div>\n\t\t\t\t<div id=\"catlinks\" class=\"catlinks\" data-mw=\"interface\"><div id=\"mw-normal-catlinks\" class=\"mw-normal-catlinks\"><a href=\"/wiki/Special:Categories\" title=\"Special:Categories\">Categories</a>: <ul><li><a href=\"/wiki/Category:Upcoming\" title=\"Category:Upcoming\">Upcoming</a></li><li><a href=\"/wiki/Category:Nethack-367_articles\" title=\"Category:Nethack-367 articles\">Nethack-367 articles</a></li><li><a href=\"/wiki/Category:Development\" title=\"Category:Development\">Development</a></li></ul></div></div>\t\t\t\t<div class=\"visualClear\"></div>\n\t\t\t\t\t\t\t</div>\n\t\t</div>\n\t\t<div id=\"mw-navigation\">\n\t\t\t<h2>Navigation menu</h2>\n\t\t\t<div id=\"mw-head\">\n\t\t\t\t\t\t\t\t\t<div id=\"p-personal\" role=\"navigation\" class=\"\" aria-labelledby=\"p-personal-label\">\n\t\t\t\t\t\t<h3 id=\"p-personal-label\">Personal tools</h3>\n\t\t\t\t\t\t<ul>\n\t\t\t\t\t\t\t<li id=\"pt-createaccount\"><a href=\"/index.php?title=Special:CreateAccount&amp;returnto=Integer+overflow\" title=\"You are encouraged to create an account and log in; however, it is not mandatory\">Create account</a></li><li id=\"pt-login\"><a href=\"/index.php?title=Special:UserLogin&amp;returnto=Integer+overflow\" title=\"You are encouraged to log in; however, it is not mandatory [o]\" accesskey=\"o\">Log in</a></li>\t\t\t\t\t\t</ul>\n\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div id=\"left-navigation\">\n\t\t\t\t\t\t\t\t\t\t<div id=\"p-namespaces\" role=\"navigation\" class=\"vectorTabs\" aria-labelledby=\"p-namespaces-label\">\n\t\t\t\t\t\t<h3 id=\"p-namespaces-label\">Namespaces</h3>\n\t\t\t\t\t\t<ul>\n\t\t\t\t\t\t\t<li id=\"ca-nstab-main\" class=\"selected\"><span><a href=\"/wiki/Integer_overflow\" title=\"View the content page [c]\" accesskey=\"c\">Page</a></span></li><li id=\"ca-talk\"><span><a href=\"/wiki/Talk:Integer_overflow\" rel=\"discussion\" title=\"Discussion about the content page [t]\" accesskey=\"t\">Discussion</a></span></li>\t\t\t\t\t\t</ul>\n\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<div id=\"p-variants\" role=\"navigation\" class=\"vectorMenu emptyPortlet\" aria-labelledby=\"p-variants-label\">\n\t\t\t\t\t\t\t\t\t\t\t\t<input type=\"checkbox\" class=\"vectorMenuCheckbox\" aria-labelledby=\"p-variants-label\" />\n\t\t\t\t\t\t<h3 id=\"p-variants-label\">\n\t\t\t\t\t\t\t<span>Variants</span>\n\t\t\t\t\t\t</h3>\n\t\t\t\t\t\t<div class=\"menu\">\n\t\t\t\t\t\t\t<ul>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t<div id=\"right-navigation\">\n\t\t\t\t\t\t\t\t\t\t<div id=\"p-views\" role=\"navigation\" class=\"vectorTabs\" aria-labelledby=\"p-views-label\">\n\t\t\t\t\t\t<h3 id=\"p-views-label\">Views</h3>\n\t\t\t\t\t\t<ul>\n\t\t\t\t\t\t\t<li id=\"ca-view\" class=\"collapsible selected\"><span><a href=\"/wiki/Integer_overflow\">Read</a></span></li><li id=\"ca-viewsource\" class=\"collapsible\"><span><a href=\"/index.php?title=Integer_overflow&amp;action=edit\" title=\"This page is protected.&#10;You can view its source [e]\" accesskey=\"e\">View source</a></span></li><li id=\"ca-history\" class=\"collapsible\"><span><a href=\"/index.php?title=Integer_overflow&amp;action=history\" title=\"Past revisions of this page [h]\" accesskey=\"h\">View history</a></span></li>\t\t\t\t\t\t</ul>\n\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<div id=\"p-cactions\" role=\"navigation\" class=\"vectorMenu emptyPortlet\" aria-labelledby=\"p-cactions-label\">\n\t\t\t\t\t\t<input type=\"checkbox\" class=\"vectorMenuCheckbox\" aria-labelledby=\"p-cactions-label\" />\n\t\t\t\t\t\t<h3 id=\"p-cactions-label\"><span>More</span></h3>\n\t\t\t\t\t\t<div class=\"menu\">\n\t\t\t\t\t\t\t<ul>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<div id=\"p-search\" role=\"search\">\n\t\t\t\t\t\t<h3>\n\t\t\t\t\t\t\t<label for=\"searchInput\">Search</label>\n\t\t\t\t\t\t</h3>\n\t\t\t\t\t\t<form action=\"/index.php\" id=\"searchform\">\n\t\t\t\t\t\t\t<div id=\"simpleSearch\">\n\t\t\t\t\t\t\t\t<input type=\"search\" name=\"search\" placeholder=\"Search NetHackWiki\" title=\"Search NetHackWiki [f]\" accesskey=\"f\" id=\"searchInput\"/><input type=\"hidden\" value=\"Special:Search\" name=\"title\"/><input type=\"submit\" name=\"fulltext\" value=\"Search\" title=\"Search the pages for this text\" id=\"mw-searchButton\" class=\"searchButton mw-fallbackSearchButton\"/><input type=\"submit\" name=\"go\" value=\"Go\" title=\"Go to a page with this exact name if it exists\" id=\"searchButton\" class=\"searchButton\"/>\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</form>\n\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div id=\"mw-panel\">\n\t\t\t\t<div id=\"p-logo\" role=\"banner\"><a class=\"mw-wiki-logo\" href=\"/wiki/Main_Page\"  title=\"Visit the main page\"></a></div>\n\t\t\t\t\t\t<div class=\"portal\" role=\"navigation\" id=\"p-navigation\" aria-labelledby=\"p-navigation-label\">\n\t\t\t<h3 id=\"p-navigation-label\">Navigation</h3>\n\t\t\t<div class=\"body\">\n\t\t\t\t\t\t\t\t<ul>\n\t\t\t\t\t<li id=\"n-NetHack-Wiki\"><a href=\"/wiki/Main_Page\">NetHack Wiki</a></li><li id=\"n-Forum\"><a href=\"/wiki/Forum:Watercooler\">Forum</a></li><li id=\"n-portal\"><a href=\"/wiki/NetHackWiki:Community_Portal\" title=\"About the project, what you can do, where to find things\">Community portal</a></li><li id=\"n-recentchanges\"><a href=\"/wiki/Special:RecentChanges\" title=\"A list of recent changes in the wiki [r]\" accesskey=\"r\">Recent changes</a></li><li id=\"n-randompage\"><a href=\"/wiki/Special:Random\" title=\"Load a random page [x]\" accesskey=\"x\">Random page</a></li>\t\t\t\t</ul>\n\t\t\t\t\t\t\t</div>\n\t\t</div>\n\t\t\t<div class=\"portal\" role=\"navigation\" id=\"p-Popular_pages\" aria-labelledby=\"p-Popular_pages-label\">\n\t\t\t<h3 id=\"p-Popular_pages-label\">Popular pages</h3>\n\t\t\t<div class=\"body\">\n\t\t\t\t\t\t\t\t<ul>\n\t\t\t\t\t<li id=\"n-Dungeon-features\"><a href=\"/wiki/Dungeon_feature\">Dungeon features</a></li><li id=\"n-Monsters\"><a href=\"/wiki/Monster#Canonical_list_of_monsters\">Monsters</a></li><li id=\"n-In.2FExtrinsics\"><a href=\"/wiki/Property#Intrinsic_properties\">In/Extrinsics</a></li><li id=\"n-Items\"><a href=\"/wiki/Item\">Items</a></li><li id=\"n-Spells\"><a href=\"/wiki/Spellbook#List_of_spellbooks\">Spells</a></li><li id=\"n-Game-options\"><a href=\"/wiki/Options\">Game options</a></li><li id=\"n-Websites\"><a href=\"/wiki/Websites\">Websites</a></li>\t\t\t\t</ul>\n\t\t\t\t\t\t\t</div>\n\t\t</div>\n\t\t\t<div class=\"portal\" role=\"navigation\" id=\"p-contributing\" aria-labelledby=\"p-contributing-label\">\n\t\t\t<h3 id=\"p-contributing-label\">Contributing</h3>\n\t\t\t<div class=\"body\">\n\t\t\t\t\t\t\t\t<ul>\n\t\t\t\t\t<li id=\"n-Style-guide\"><a href=\"/wiki/NetHackWiki:Style_guide\">Style guide</a></li><li id=\"n-help\"><a href=\"/wiki/NetHackWiki:How_to_help\" title=\"The place to find out\">How to help</a></li><li id=\"n-Current-projects\"><a href=\"/wiki/NetHackWiki:Current_projects\">Current projects</a></li>\t\t\t\t</ul>\n\t\t\t\t\t\t\t</div>\n\t\t</div>\n\t\t\t<div class=\"portal\" role=\"navigation\" id=\"p-tb\" aria-labelledby=\"p-tb-label\">\n\t\t\t<h3 id=\"p-tb-label\">Tools</h3>\n\t\t\t<div class=\"body\">\n\t\t\t\t\t\t\t\t<ul>\n\t\t\t\t\t<li id=\"t-whatlinkshere\"><a href=\"/wiki/Special:WhatLinksHere/Integer_overflow\" title=\"A list of all wiki pages that link here [j]\" accesskey=\"j\">What links here</a></li><li id=\"t-recentchangeslinked\"><a href=\"/wiki/Special:RecentChangesLinked/Integer_overflow\" rel=\"nofollow\" title=\"Recent changes in pages linked from this page [k]\" accesskey=\"k\">Related changes</a></li><li id=\"t-specialpages\"><a href=\"/wiki/Special:SpecialPages\" title=\"A list of all special pages [q]\" accesskey=\"q\">Special pages</a></li><li id=\"t-print\"><a href=\"/index.php?title=Integer_overflow&amp;printable=yes\" rel=\"alternate\" title=\"Printable version of this page [p]\" accesskey=\"p\">Printable version</a></li><li id=\"t-permalink\"><a href=\"/index.php?title=Integer_overflow&amp;oldid=174240\" title=\"Permanent link to this revision of the page\">Permanent link</a></li><li id=\"t-info\"><a href=\"/index.php?title=Integer_overflow&amp;action=info\" title=\"More information about this page\">Page information</a></li>\t\t\t\t</ul>\n\t\t\t\t\t\t\t</div>\n\t\t</div>\n\t\t\t\t</div>\n\t\t</div>\n\t\t\t\t<div id=\"footer\" role=\"contentinfo\">\n\t\t\t\t\t\t<ul id=\"footer-info\">\n\t\t\t\t\t\t\t\t<li id=\"footer-info-lastmod\"> This page was last edited on 5 July 2024, at 00:13.</li>\n\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t<ul id=\"footer-places\">\n\t\t\t\t\t\t\t\t<li id=\"footer-places-about\"><a href=\"/wiki/NetHackWiki:About\" title=\"NetHackWiki:About\">About NetHackWiki</a></li>\n\t\t\t\t\t\t\t\t<li id=\"footer-places-disclaimer\"><a href=\"/wiki/NetHackWiki:General_disclaimer\" title=\"NetHackWiki:General disclaimer\">Disclaimers</a></li>\n\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t\t\t\t\t<ul id=\"footer-icons\" class=\"noprint\">\n\t\t\t\t\t\t\t\t\t\t<li id=\"footer-poweredbyico\">\n\t\t\t\t\t\t<a href=\"//www.mediawiki.org/\"><img src=\"/resources/assets/poweredby_mediawiki_88x31.png\" alt=\"Powered by MediaWiki\" srcset=\"/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /resources/assets/poweredby_mediawiki_176x62.png 2x\" width=\"88\" height=\"31\"/></a>\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t<div style=\"clear: both;\"></div>\n\t\t</div>\n\t\t\n<script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({\"wgPageParseReport\":{\"limitreport\":{\"cputime\":\"0.026\",\"walltime\":\"0.032\",\"ppvisitednodes\":{\"value\":336,\"limit\":1000000},\"ppgeneratednodes\":{\"value\":1741,\"limit\":1000000},\"postexpandincludesize\":{\"value\":3590,\"limit\":2097152},\"templateargumentsize\":{\"value\":1045,\"limit\":2097152},\"expansiondepth\":{\"value\":9,\"limit\":40},\"expensivefunctioncount\":{\"value\":0,\"limit\":100},\"unstrip-depth\":{\"value\":0,\"limit\":20},\"unstrip-size\":{\"value\":1841,\"limit\":5000000},\"timingprofile\":[\"100.00%   20.800      1 -total\",\" 30.58%    6.360      2 Template:Refsrc\",\" 22.97%    4.777      1 Template:Nethack-367\",\" 18.89%    3.929      1 Template:Upcoming\",\" 16.26%    3.383      1 Template:Version_icon\",\" 12.65%    2.631      1 Template:Wikipedia\",\" 12.60%    2.620      1 Template:Message\",\" 12.54%    2.608      2 Template:Refsrc/link\",\"  9.84%    2.046      1 Template:Top_icon\",\"  6.02%    1.253      1 Template:Generic_project_link\"]},\"cachereport\":{\"timestamp\":\"20240926184138\",\"ttl\":604800,\"transientcontent\":false}}});mw.config.set({\"wgBackendResponseTime\":66});});</script>\n\t</body>\n</html>\n","rawPage":"{{Wikipedia|Integer overflow}}\n\n'''Integer overflow''' occurs when an integer value exceeds the range of its data type.\n\nFor a [[signed variable]], the exact behavior is [[wikipedia:undefined behavior|undefined behavior]] by the C standard. Often what happens, due to [[wikipedia:Two's complement|two's complement arithmetic]], is that the variable wraps to the opposite end of the range: a negative value just beyond the range would become a large positive value, and vice versa. For an unsigned variable, the C standard does define the exact behavior: an unsigned variable that exceeds its capacity becomes a small positive value, or zero, and subtracting too much from a small unsigned variable produces a large value.\n\n''[[NetHack]]'' protects most variables against integer overflow, both signed and unsigned - however, it is possible to find ways to avoid these limits in [[wizard mode]].  For example, in wizard mode, the character might wish for one billion dwarf corpses, producing an object stack whose total weight may appear to be negative (depending on details of the C implementation used to run NetHack).\n\nAny case where an ordinary game (not in wizard mode) can produce an integer overflow is likely to be a [[software bug]].\n\n== Current overflows ==\n\n=== Wrapping the turn counter ===\n\nIn NetHack 3.6.7 and earlier versions, the turn counter has no protection against overflow.{{refsrc|nethack=3.6.7|src/allmain.c|172}}\n\n[[NAO]] reports one game that ended with less than 0 turns played.<ref>https://s3.amazonaws.com/altorg/dumplog/Khaos/1291644901.nh343.txt</ref>. There are no ascended games with 1 turn or any number of turns less than 2000.\n\nSince that time, NAO switched from 32-bit binaries to 64-bit binaries, as evidenced by several games recorded with scores higher than 2,147,483,647. Nowadays, wrapping the turn counter on an NAO game would take 4 billion times as long as previously.\n\n{{upcoming|NetHack 3.7.0|For games running over 100000 turns, [[prayer]] timeout increases by 1 every 100 turns - this is implemented to prevent denial-of-service attacks against [[public server]]s. If a game runs over one billion turns, it ends immediately in an [[Escaping the dungeon|escape]]:\n{{message|The dungeon capitulates.}}}}\n\n== History ==\nIn [[NetHack 3.4.3]] and previous versions, including some variants based on those versions, cases of integer overflow that are fixed in [[NetHack 3.6.0]] include:\n\n* [[Negative gold]]\n* Extreme [[intrinsic protection]] from [[prayer]]\n* Extreme bonuses to hit or to damage from [[eating jewelry]]\n\nWrapping the score<ref>NAO game by ctaboir on 2006-10-03 with score -2,147,474,899; dumplog not available</ref><ref>[[NAO]] game by pug on 2007-11-12 with score -2,145,868,906; dumplog not available</ref> is supposed to be fixed, but the fix relies on signed integer overflow, which is undefined behaviour.{{refsrc|nethack=3.6.7|src/end.c|19|comment=macro nowrap_add}}\n\n== References ==\n<references/>\n{{nethack-367}}\n[[Category:Development]]"}